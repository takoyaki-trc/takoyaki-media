<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>露店</title>
  <link rel="stylesheet" href="assets/roten.css">
</head>
<body>

<header class="roten-header">
  <div class="roten-title">露店</div>
  <div class="roten-sub">マイ露店 / たこぴのお店</div>
</header>

<main id="rotenApp" class="roten-app">

  <!-- ====== TOP BAR ====== -->
  <div class="roten-topbar">
    <div class="roten-balrow">
      <div class="roten-balance">
        <span class="tag">《オクト》</span>
        <span class="num" id="octoNow">0</span>
      </div>

      <!-- 種/水/肥料チップ（タップで所持資材モーダル） -->
      <div class="roten-goods">
        <button class="gchip" id="btnOpenInv" type="button" title="所持資材を見る">
          <span class="gico">🌱</span><span>種</span><span class="gnum" id="chipSeed">0</span>
          <span style="opacity:.7;font-size:12px">/</span>
          <span class="gico">💧</span><span>水</span><span class="gnum" id="chipWater">0</span>
          <span style="opacity:.7;font-size:12px">/</span>
          <span class="gico">🧪</span><span>肥料</span><span class="gnum" id="chipFert">0</span>
        </button>
      </div>
    </div>

    <div style="display:flex;gap:8px;align-items:center;">
      <button class="btn btn-ghost" id="btnGiveOcto" type="button">+100（テスト）</button>
    </div>
  </div>

  <!-- ====== TABS（他店露店を削除して2タブ） ====== -->
  <div class="roten-tabs" role="tablist" aria-label="露店タブ">
    <!-- ★マイ露店：別ページへリンク -->
    <a
      class="roten-tab"
      href="https://takoyaki-trc.github.io/takoyaki-media/town/myshop.html"
      role="tab"
      aria-selected="false"
      style="text-decoration:none; display:inline-flex; align-items:center; justify-content:center;"
    >
      マイ露店へ
    </a>

    <!-- ★たこぴのお店：このページ内タブ -->
    <button class="roten-tab is-active" data-tab="takopi" type="button" role="tab" aria-selected="true">
      たこぴのお店
    </button>
  </div>

  <!-- ====== PANELS（他店露店・マイ露店枠は削除） ====== -->

  <!-- ====== TAKOPI SHOP ====== -->
  <section class="roten-panel is-show" data-panel="takopi">
    <div class="roten-card takopi-card">
      <div class="roten-card__title">たこぴのお店（資材ショップ）</div>
      <div class="roten-card__text">オクトで「種/水/肥料」を買える。買った資材は <b>ファーム(tf_v1_inv)</b> に入る。</div>

      <div class="takopi-hero">
        <img class="takopi-face" id="takopiImg" alt="たこぴ" src="https://ul.h3z.jp/6MpVi7u2.png">
        <div class="takopi-bubble">
          <div class="takopi-bubble__name">たこぴ</div>
          <div class="takopi-bubble__text" id="takopiSay">
            「いらっしゃい…たこ。<br>オクトで“未来”を買うの、すき…たこ？」
          </div>
          <div class="takopi-bubble__sub muted">※無料資材は∞なので買えない（買う意味がない）</div>

          <div class="takopi-mini">
            <div class="takopi-mini__chip is-click" id="btnTakopiInv">所持資材を見る</div>
            <div class="takopi-mini__chip is-click" id="btnTakopiRates">水のレア率メモ</div>
          </div>
        </div>
      </div>

      <div class="takopi-tabs" aria-label="たこぴのお店タブ">
        <button class="takopi-tab is-active" data-takotab="seed" type="button">種</button>
        <button class="takopi-tab" data-takotab="water" type="button">水</button>
        <button class="takopi-tab" data-takotab="fert" type="button">肥料</button>
      </div>

      <div class="takopi-shopgrid">
        <div class="takopi-panel">
          <div class="takopi-ptitle">購入</div>
          <div class="takopi-goods" id="takopiGoods"></div>
          <div class="takopi-foot muted">購入した資材は即反映される。</div>
        </div>

        <div class="takopi-panel">
          <div class="takopi-ptitle">たこぴメモ</div>
          <div class="roten-card__text" id="takopiExplain">
            「水は“運”、肥料は“代償”、種は“物語”。…ねぇ、知ってるたこ？」
          </div>

          <div class="takopi-lottery">
            <div class="takopi-row">
              <div class="muted">おまけ（演出用）</div>
              <button class="btn" id="btnTakopiTalk" type="button">たこぴの一言</button>
            </div>
            <div class="takopi-reveal" id="takopiReveal">……</div>
          </div>
        </div>
      </div>

    </div>
  </section>

</main>

<!-- ====== MODAL ====== -->
<div class="modal" id="modal">
  <div class="modal__backdrop" id="modalBg"></div>
  <div class="modal__sheet" role="dialog" aria-label="モーダル">
    <div class="modal__grab"></div>
    <div class="modal__head">
      <div class="modal__title" id="modalTitle">タイトル</div>
      <button class="btn modal__x" id="modalX" type="button">閉じる</button>
    </div>
    <div id="modalBody"></div>
  </div>
</div>

<script src="assets/roten.js"></script>

<!-- ★リンクタブを「押した感」にする（最低限の見た目補助） -->
<script>
(() => {
  const tabs = document.querySelectorAll(".roten-tabs .roten-tab");
  tabs.forEach(t => t.classList.remove("is-active"));
  // たこぴタブを常にアクティブ表示（ページ内表示がたこぴだけなので）
  const takopiBtn = document.querySelector('.roten-tab[data-tab="takopi"]');
  if(takopiBtn) takopiBtn.classList.add("is-active");
})();
</script>

</body>
</html>
