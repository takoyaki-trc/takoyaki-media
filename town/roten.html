<!-- roten.html -->
<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>露店</title>
  <link rel="stylesheet" href="assets/roten.css">
</head>
<body>

 <header class="roten-header">
  <button id="rotenBackBtn" class="roten-back" type="button" aria-label="戻る">←</button>
  <div class="roten-headtext">
    <h1 class="roten-title">露店</h1>
    <div class="roten-sub">他店露店 / マイ露店</div>
  </div>
</header>


  <main id="rotenApp" class="roten-app">
    <div class="roten-topbar">
      <div class="roten-balance">
        <span class="tag">《オクト》</span>
        <span id="rotenOcto" class="num">0</span>
      </div>

      <button id="rotenResetBtn" class="btn btn-ghost" type="button">テスト初期化</button>
    </div>

    <div class="roten-tabs">
      <button class="roten-tab is-active" data-tab="npc">他店露店</button>
      <button class="roten-tab" data-tab="my">マイ露店</button>
    </div>

  <section class="roten-panel is-show" data-panel="npc">
  <div class="roten-card">
    <div class="roten-card__title">他店露店（後で実装）</div>
    <div class="roten-card__text">
      まずはマイ露店の操作性＆演出を完成させる。<br>
      ※ここは後で「即時取引」「日替わり怪しい取引」を入れる。
    </div>
    <pre id="rotenDebugNpc" class="roten-debug"></pre>
  </div>

  <!-- ✅ テスト購入は外に出す（ここが重要） -->
  <div class="roten-card" style="margin-top:12px;">
    <div class="roten-card__title">テスト購入（在庫を増やす）</div>
    <div class="roten-card__text">
      露店の購入処理ができるまでの仮ボタン。押すとファームの在庫が増える。
    </div>

    <div style="display:flex; gap:8px; flex-wrap:wrap;">
      <button class="btn" type="button" data-buy="seed_shop">店頭タネ +1</button>
      <button class="btn" type="button" data-buy="seed_line">回線タネ +1</button>
      <button class="btn" type="button" data-buy="seed_special">たこぴのタネ +1</button>
      <button class="btn" type="button" data-buy="seed_colabo">コラボのタネ +1</button>

      <button class="btn" type="button" data-buy="water_nice">なんか良さそうな水 +1</button>
      <button class="btn" type="button" data-buy="water_suspicious">怪しい水 +1</button>
      <button class="btn" type="button" data-buy="water_overdo">やりすぎな水 +1</button>
      <button class="btn" type="button" data-buy="water_regret">押さなきゃよかった水 +1</button>

      <button class="btn" type="button" data-buy="fert_feel">気のせい肥料 +1</button>
      <button class="btn" type="button" data-buy="fert_guts">根性論肥料 +1</button>
      <button class="btn" type="button" data-buy="fert_skip">工程すっ飛ばし肥料 +1</button>
      <button class="btn" type="button" data-buy="fert_timeno">時間を信じない肥料 +1</button>
    </div>

    <div class="hint" id="rotenBuyHint"></div>
  </div>
</section>

    <section class="roten-panel" data-panel="my">

      <div class="roten-card">
        <div class="roten-card__title">今日の市場</div>
        <div class="roten-grid2">
          <div>
            <div class="muted">客層の空気</div>
            <div id="rotenMood" class="bigline">…</div>
          </div>
          <div>
            <div class="muted">次の更新</div>
            <div id="rotenRollover" class="bigline">…</div>
          </div>
        </div>
        <div class="hint">※答えは教えない。雰囲気だけ。</div>
      </div>

      <div class="roten-card">
        <div class="roten-card__title">マイ露店（棚をタップして出品）</div>
        <div class="hint">棚1〜5：最初は2枠解放。出店中はタコ民が見に来る。</div>
        <div id="rotenDisplays" class="displays"></div>
      </div>

      <div class="roten-card">
        <div class="roten-card__title">持ち物（所持枚数が見える）</div>
        <div class="toolbar">
          <input id="rotenInvSearch" class="inp" type="search" placeholder="検索（名前 / ID）">
          <select id="rotenInvSort" class="sel">
            <option value="new">新しい順</option>
            <option value="id">ID順</option>
            <option value="rarity">レア順</option>
            <option value="count">枚数順</option>
          </select>
        </div>
        <div id="rotenInventory" class="inv"></div>
        <div class="hint">※棚をタップ → カード選択で出品します（ここは一覧確認用）。</div>
      </div>

      <div class="roten-card">
        <div class="roten-card__title">露店ログ</div>
        <div id="rotenLog" class="log"></div>
      </div>
    </section>
  </main>

  <!-- 棚モーダル（カード選択 → 設定 → 開始） -->
  <div id="rotenModal" class="modal" aria-hidden="true">
    <div class="modal__backdrop" data-close="1"></div>
    <div class="modal__sheet" role="dialog" aria-label="棚の操作">
      <div class="modal__grab"></div>

      <div class="modal__head">
        <div class="modal__title" id="rotenModalTitle">棚</div>
        <button class="btn btn-ghost modal__x" type="button" data-close="1">×</button>
      </div>

      <div class="modal__body">
        <!-- 現在の棚 -->
        <div id="rotenModalSlotBox" class="slotbox"></div>

        <!-- カード選択（まとめ表示） -->
        <div class="pickhead">
          <div class="picktitle">カードを選ぶ</div>
          <div class="picksub muted">※同じカードはまとめて表示（×枚数）</div>
        </div>
        <div class="toolbar">
          <input id="rotenPickSearch" class="inp" type="search" placeholder="検索（名前 / ID）">
          <select id="rotenPickSort" class="sel">
            <option value="new">新しい順</option>
            <option value="id">ID順</option>
            <option value="rarity">レア順</option>
            <option value="count">枚数順</option>
          </select>
        </div>
        <div id="rotenPickList" class="picklist"></div>

        <!-- 価格/時間 -->
        <div class="mform">
          <label class="mlabel">価格</label>
          <div class="mrow">
            <button class="btn" data-tier="low" type="button">安い</button>
            <button class="btn" data-tier="mid" type="button">普通</button>
            <button class="btn" data-tier="high" type="button">強気</button>
          </div>

          <label class="mlabel">時間</label>
          <div class="mrow">
            <button class="btn" data-dur="1h" type="button">1時間</button>
            <button class="btn" data-dur="3h" type="button">3時間</button>
            <button class="btn" data-dur="6h" type="button">6時間</button>
          </div>

          <div class="mcta">
            <button id="rotenModalAssign" class="btn btn-primary" type="button">棚に置く</button>
            <button id="rotenModalStart" class="btn btn-primary" type="button">置いて出店開始</button>
          </div>

          <div id="rotenModalHint" class="hint"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- データ -->
  <script src="assets/roten.customers.js"></script>
  <script src="assets/roten.market.js"></script>

  <!-- ロジック -->
  <script src="assets/roten.js"></script>
</body>
</html>

