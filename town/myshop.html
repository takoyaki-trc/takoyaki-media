<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>マイ露店</title>
  <link rel="stylesheet" href="assets/myshop.css" />
</head>
<body>

<header class="header">
  <div class="head-inner">
    <button id="backBtn" class="back" type="button" aria-label="戻る">←</button>
    <div class="titlebox">
      <div class="title">マイ露店</div>
      <div class="card-desc">夜祭り屋台モード / 売買は「来店ステージ」で発生</div>
    </div>

    <div class="top-actions">
      <button id="helpBtn" class="btn ghost" type="button" aria-label="ヘルプ">？</button>
    </div>
  </div>
</header>

<main class="wrap">

  <!-- 来店ステージ（ここにステータスを移動） -->
  <section class="card stage-card">
    <div class="card-h">
      <div>
        <div class="card-title">来店ステージ</div>
        <div class="card-desc">背景（昼/夜）に、客タコ民（透過）を重ねて表示。誰もいない時は背景だけ。</div>
      </div>

      <div class="top-actions">
        <button id="fixBtn" class="btn ghost" type="button">修理</button>
      </div>
    </div>

    <div class="card-b">

      <!-- ✅ ステータスを「来店ステージ内」に移動（コンパクト表示はCSS側で） -->
      <div class="stage-status" aria-label="ステータス（コンパクト）">
        <div class="stage-status-head">
          <div class="stage-status-title">ステータス</div>
          <div class="stage-status-tip">TIP：評判が高いほど客層が良くなる</div>
        </div>
        <div id="stats" class="stats stats--compact"></div>
      </div>

      <div class="stage" aria-label="来店ステージ">
        <img id="stageBg" class="stage-bg" src="" alt="背景">
        <img id="stageVisitor" class="stage-visitor" src="" alt="来客">

        <!-- ステージ上にはタグだけ残す -->
        <div class="stage-ui">
          <div></div>
          <div class="stage-tags">
            <div id="stageTimeTag" class="tag">—</div>
            <div id="stageNextTag" class="tag">次：—</div>
          </div>
        </div>
      </div>

      <!-- セリフ（下に移動済み） -->
      <div class="stage-speechbox" aria-label="ステージセリフ">
        <div class="bubble bubble--moved">
          <div id="stageName" class="n">—</div>
          <div id="stageMsg" class="m">まだ誰も来ていない。</div>
        </div>
      </div>
    </div>
  </section>

  <!-- 棚 -->
  <section class="card" style="margin-top:12px">
    <div class="card-h">
      <div>
        <div class="card-title">棚</div>
        <div class="card-desc">棚をタップしてダブりカードを出品（図鑑に1枚残して余った分だけ）</div>
      </div>
    </div>
    <div class="card-b">
      <div id="shelves" class="shelves"></div>
    </div>
  </section>

  <!-- ログ -->
  <section class="card" style="margin-top:12px">
    <div class="card-h">
      <div>
        <div class="card-title">ログ</div>
        <div class="card-desc">出品 / 売れた / 呼び込み / 待機 など</div>
      </div>
    </div>
    <div class="card-b">
      <div id="log" class="log"></div>
    </div>
  </section>

</main>

<!-- 右下固定 -->
<div class="fab-wrap" aria-label="クイック操作">
  <button id="shoutBtn" class="btn primary" type="button">呼び込み</button>
  <div id="shoutCd" class="cd">CD: OK</div>

  <button id="backupBtn" class="btn ghost" type="button">バックアップ</button>
  <button id="restoreBtn" class="btn ghost" type="button">復元</button>
  <input id="restoreFile" type="file" accept="application/json" hidden>
</div>

<!-- ヘルプ -->
<div id="helpModal" class="modal" aria-hidden="true">
  <div class="sheet" role="dialog" aria-modal="true" aria-label="ヘルプ">
    <div class="sheet-h">
      <b>ヘルプ</b>
      <button id="helpClose" class="btn ghost close" type="button" aria-label="閉じる">×</button>
    </div>
    <div class="sheet-b">
      <div class="line">・棚にダブりカードを出品すると来客が発生します。</div>
      <div class="line">・売れたらオクトが増え、評判やレベルが変化します。</div>
      <div class="line">・呼び込みは右下のボタン（CDあり）。</div>
      <div class="line">・バックアップは端末内にJSON保存、復元で戻せます。</div>
    </div>
    <div class="sheet-actions">
      <button id="helpOk" class="btn primary" type="button">OK</button>
    </div>
  </div>
</div>

<!-- 出品ピッカー -->
<div id="pickModal" class="modal" aria-hidden="true">
  <div class="sheet" role="dialog" aria-modal="true" aria-label="出品カード選択">
    <div class="sheet-h">
      <b id="pickTitle">棚に出品するカード</b>
      <button id="pickClose" class="btn ghost close" type="button" aria-label="閉じる">×</button>
    </div>
    <div class="sheet-b">
      <div id="pickHint" class="card-desc" style="margin-bottom:10px"></div>
      <div id="pickEmpty" class="card-desc" style="display:none">出品できるダブりがありません。</div>
      <div id="pickCards" class="cards"></div>
    </div>
    <div class="sheet-actions">
      <button id="pickCancel" class="btn ghost" type="button">キャンセル</button>
    </div>
  </div>
</div>

<!-- Toast -->
<div class="toast" aria-live="polite">
  <div id="toastBox" class="box">
    <div><b id="toastTitle">—</b></div>
    <div id="toastSub" class="small"></div>
  </div>
</div>
<div id="saleFlash" class="sale-flash"></div>

<script src="assets/myshop.js"></script>
</body>
</html>



