<!DOCTYPE html>
<html lang="ja">
<head>


<!-- ã‚¢ã‚¯ã‚»ã‚¹è§£æ -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-D3RHSWHL9J"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-D3RHSWHL9J');
</script>

 <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">


 
  <meta charset="utf-8">
  <meta name="viewport" content="viewport-fit=cover, width=device-width, initial-scale=1.0, maximum-scale=1.0">
<style>
/* ç©ºãƒ¬ã‚¤ãƒ¤ãƒ¼ï¼šBASEã®èƒŒæ™¯ã«è² ã‘ãªã„ */
body::before{
  content:"";
  position: fixed;
  inset: 0;
  z-index: -1;
  pointer-events: none;

  /* 3å±¤ï¼‹ãƒ“ãƒãƒƒãƒˆ */
  background:
    /* ãƒ“ãƒãƒƒãƒˆï¼ˆç«¯ã‚’å°‘ã—æš—ãï¼‰ */
    radial-gradient(
      ellipse at center,
      rgba(0,0,0,0) 55%,
      rgba(0,0,0,0.18) 100%
    ),
    /* ç©ºã®3å±¤ï¼ˆJSãŒã“ã“ã‚’æ›¸ãæ›ãˆã‚‹ï¼‰ */
    var(--sky, linear-gradient(
      #87b8e5 0%,
      #cfe8ff 55%,
      #ffffff 100%
    ));

  transition: background 6s linear;
}

/* ===== å¤ªé™½ / æœˆ ãƒ¬ã‚¤ãƒ¤ãƒ¼ ===== */

/* â€œä»Šã®ä½ç½®â€ã ã‘å…‰ã‚‹ */
.phase-dot.is-active{
  opacity: 1;
  transform: scale(1.0);
  filter: drop-shadow(0 0 6px rgba(255,255,255,0.35));
}

/* å¤ªé™½ï¼ˆå·¦ç«¯ï¼‰ */
.phase-dot.sun{
  background: radial-gradient(circle at 30% 30%, #fff7c8 0%, #ffd86b 55%, #f2b705 100%);
  box-shadow: 0 0 14px rgba(255,200,80,0.35);
}

/* æœˆã®ãƒ™ãƒ¼ã‚¹ï¼ˆå³ç«¯å´ï¼‰ */
.phase-dot.moon{
  background: radial-gradient(circle at 35% 30%, #ffffff 0%, #e6e6e6 70%, #cfcfcf 100%);
}

/* æœˆç›¸ï¼šé»’ã„å½±ã‚’é‡ã­ã¦æ¬ ã‘ã‚’ä½œã‚‹ï¼ˆCSSã ã‘ã§OKï¼‰ */
.phase-dot.moon::after{
  content:"";
  position:absolute;
  inset:0;
  border-radius:50%;
  background: rgba(15,20,32,0.95);
  transform: translateX(var(--shadow-x, 0px));
}

/* ç«¯æœ«ã§å¤§ãã•èª¿æ•´ã—ãŸã„ãªã‚‰ã“ã“ã ã‘è§¦ã‚‹ */
@media (max-width:480px){
  #phase-strip .phase-dot{ width:36px; height:36px; }
}

/* ===== å¤ªé™½ï¼æœˆãŒå‹•ããƒ¬ãƒ¼ãƒ« ===== */
#phase-strip{
  position: relative;
  width: 220px;          /* æ¨ªå¹…ï¼ˆå¥½ã¿ã§èª¿æ•´OKï¼‰ */
  height: 54px !important;
  margin: 0 auto 4px !important;  /* ä¸‹ã ã‘4pxã« */
  padding: 0 !important;
}

/* ===== å‹•ãæœ¬ä½“ï¼ˆå…±é€šï¼‰ ===== */
#phase-orb{
  position: absolute;
  top: 0 !important;
  left: 0;
  width: 40px;
  height: 40px;
  border-radius: 50%;
  image-rendering: pixelated;
  transition:
    transform 0.6s ease,
    filter 0.6s ease,
    background 0.6s ease;
}

/* ===== å¤ªé™½ï¼ˆæ˜¼ï¼‰ ===== */
#phase-orb.sun{
  background: radial-gradient(
    circle at 30% 30%,
    #fff7c8 0%,
    #ffd86b 55%,
    #f2b705 100%
  );
  box-shadow: 0 0 14px rgba(255,200,80,0.35);
  transform: scale(1);     /* å¤ªé™½ã¯å¤§ãã‚ */
}

/* ===== æœˆï¼ˆå¤œï¼‰ ===== */
#phase-orb.moon{
  background: radial-gradient(
    circle at 35% 30%,
    #ffffff 0%,
    #e6e6e6 70%,
    #cfcfcf 100%
  );
  transform: scale(0.8);   /* æœˆã¯å°ã•ã */
}

/* ===== æœˆã®æº€ã¡æ¬ ã‘ï¼ˆå½±ï¼‰ ===== */
#phase-orb.moon::after{
  content:"";
  position:absolute;
  inset:0;
  border-radius:50%;
  background: rgba(15,20,32,0.95);
  transform: translateX(var(--shadow-x, 0px));
}

/* ===== ã‚¹ãƒãƒ›å¾®èª¿æ•´ ===== */
@media (max-width:480px){
  #phase-strip{ width: 200px; }
  #phase-orb{ width: 36px; height: 36px; }
}

/* ================================
   MAP åŸºæº–ï¼ˆiPhoneã‚ºãƒ¬å¯¾ç­– å®Œå…¨ç‰ˆï¼‰
   â˜…ã“ã“ã‚’ä¸¸ã”ã¨ç½®ãæ›ãˆ
================================ */

/* ä½™è¨ˆãªå·¦å³ã‚ºãƒ¬è¦å› ã‚’æ®ºã™ */
html, body{
  margin: 0;
  padding: 0;
  width: 100%;
}

/* iOSã§æ¨ªå¹…ãŒã‚ºãƒ¬ã‚‹æ™‚ã®ä¿é™ºï¼ˆè¦ªã®å½±éŸ¿ã§å³ã«å‡ºã‚‹ã®ã‚’é˜²ãï¼‰ */
body{
  overflow-x: hidden;
}

/* ã‚¿ã‚¤ãƒˆãƒ«GIFï¼ˆãã®ã¾ã¾ã§OKï¼‰ */
.title-gif{
  width: min(720px, 90%);
  margin: 0 auto 24px;
  display: block;
}

/* =========================
   MAPã®ã€Œåº§æ¨™åŸºæº–ã€
   - ç”»åƒã¨åŒã˜ç®±ï¼ˆmap-wrapï¼‰ã‚’åŸºæº–ã«ã™ã‚‹
   - ä½™è¨ˆãªpadding/transformã®å½±éŸ¿ã‚’å—ã‘ã«ããã™ã‚‹
========================= */
.map-wrap{
  position: relative !important;
  display: block;
  width: 100% !important;
  max-width: 800px;          /* PCä¸Šé™ */
  margin: 0 auto !important; /* ä¸­å¤®å›ºå®š */
  padding: 0 !important;     /* â† %åº§æ¨™ã®ã‚ºãƒ¬åŸå› ã‚’æ¶ˆã™ */
  border: 0 !important;
  box-sizing: border-box !important;

  /* iOSã®åˆæˆ/ä¸¸ã‚èª¤å·®ã§ã‚ºãƒ¬ã‚‹ã®ã‚’æŠ‘ãˆã‚‹ */
  transform: translateZ(0);
  -webkit-transform: translateZ(0);
}

/* ç”»åƒï¼šmap-wrap ã«100%ãƒ•ã‚£ãƒƒãƒˆï¼ˆä½™è¨ˆãªæŒ‡å®šã‚’å…¨éƒ¨æ½°ã™ï¼‰ */
.map-wrap .map-img{
  position: relative;        /* å¿µã®ãŸã‚ */
  display: block !important;
  width: 100% !important;
  max-width: 100% !important;
  height: auto !important;
  margin: 0 !important;
  padding: 0 !important;
  border: 0 !important;
  box-sizing: border-box !important;

  image-rendering: pixelated;

  /* iOSã§ç”»åƒãŒâ€œå¾®å¦™ã«æ¨ªã«ãšã‚Œã‚‹â€æ™‚ã®ä¿é™º */
  transform: translateZ(0);
  -webkit-transform: translateZ(0);
}

/* =========================
   å½“ãŸã‚Šåˆ¤å®š / å»ºç‰©ï¼ˆå…±é€šï¼‰
   - å¿…ãš map-wrap ã‚’åŸºæº–ã« absolute
========================= */
.map-wrap .hotspot,
.map-wrap .tf-building{
  position: absolute !important;
  display: block !important;
  z-index: 60 !important; /* ç”»åƒã‚ˆã‚Šä¸Š */
  cursor: pointer;

  /* iOSã®ã‚¿ãƒƒãƒ—/åˆæˆã‚ºãƒ¬ã‚’æŠ‘ãˆã‚‹ */
  transform: translateZ(0);
  -webkit-transform: translateZ(0);

  /* ã‚¿ãƒƒãƒ—é…å»¶/æ‹¡å¤§ã‚’æŠ‘åˆ¶ï¼ˆiPhoneå‘ã‘ï¼‰ */
  touch-action: manipulation;
  -webkit-tap-highlight-color: transparent;
}

/* å»ºç‰©ãƒªãƒ³ã‚¯å†…ã®ç”»åƒã‚‚ã€ŒåŸºæº–ç®±ã„ã£ã±ã„ã€ */
.map-wrap .tf-building > img{
  display: block;
  width: 100%;
  height: auto;
}

/* ãƒ›ãƒãƒ¼æ¼”å‡ºï¼ˆPCï¼‰ */
@media (hover:hover){
  .map-wrap .hotspot:hover,
  .map-wrap .tf-building:hover{
    outline: 2px solid rgba(255,255,200,0.9);
    box-shadow: 0 0 12px rgba(255,255,200,0.9);
  }
}

/* =========================
   èª¿æ•´ç”¨ï¼šã‚ºãƒ¬ç¢ºèªï¼ˆå¿…è¦ãªæ™‚ã ã‘ONï¼‰
   ã“ã‚Œã‚’ONã«ã™ã‚‹ã¨ã€åŸºæº–ç®±ã¨å½“ãŸã‚Šåˆ¤å®šãŒè¦‹ãˆã‚‹
========================= */
/*
.map-wrap{ outline:2px solid red; }
.map-wrap .map-img{ outline:2px solid lime; }
.map-wrap .hotspot, .map-wrap .tf-building{ background: rgba(0,255,255,0.25); }
*/

/* =========================
   ãƒ•ãƒƒã‚¿ãƒ¼ä¸‹ã®â€œã§ã‹ã„ä½™ç™½â€ã‚’æ½°ã™ï¼ˆåŸå› 2ã¤ã‚’ä¸Šæ›¸ãï¼‰
========================= */

/* â‘  footerã¯wrapperãªã®ã§ 60px ãŒåŠ¹ã„ã¦ãŸ â†’ footerã ã‘ç„¡åŠ¹åŒ– */
body.shop #mainFooter.wrapper{
  margin-bottom: 0 !important;
}

/* â‘¡ mainFooter è‡ªä½“ã« 60px auto 100px ãŒå…¥ã£ã¦ãŸ â†’ å…¨éƒ¨è©°ã‚ã‚‹ */
body.shop #mainFooter{
  margin: 20px auto 0 !important;   /* ä¸Šä¸‹ã®ä½™ç™½ã‚’å¿…è¦æœ€å°é™ã« */
  padding: 0 !important;
}

/* â‘¢ li ãŒ mobile ã§ margin-bottom:16px ã«ãªã£ã¦ã‚‹ â†’ ãƒ­ã‚´å‘¨ã‚Šã®ä½™ç™½ã«ãªã‚‹ */
body.shop #mainFooter .footerMenu ul li{
  margin-bottom: 0 !important;
}

body.shop #mainFooter.wrapper,
body.shop #mainFooter.wrapper + #base_url{
  margin: 0 !important;
  padding: 0 !important;
}


  /* ===== iPhoneé…ç½®ãƒã‚° å¼·åˆ¶Fixï¼ˆæœ€é‡è¦ï¼‰ ===== */
.map-wrap .tf-building{
  position: absolute !important;
  display: block !important;
  z-index: 60 !important;
}
/* èƒŒæ™¯ */
.map-wrap .map-img{ position: relative; z-index: 0; }

/* ãƒ›ãƒƒãƒˆã‚¹ãƒãƒƒãƒˆï¼šå¼±ãï¼ˆã‚¿ã‚³æ°‘ã‚ˆã‚Šä¸‹ï¼‰ */
.map-wrap .hotspot{ z-index: 10 !important; }

/* ç¥­å£‡ï¼ˆè¦‹ãŸç›®ï¼‰ */
.map-wrap .spot{ z-index: 20 !important; }

/* ç¥­å£‡ã®å½“ãŸã‚Šåˆ¤å®šï¼ˆå¿…è¦ãªã‚‰è¦‹ãŸç›®ã‚ˆã‚Šä¸Šï¼‰ */
.map-wrap .gate-hit{ z-index: 30 !important; }

/* å»ºç‰© */
.map-wrap .tf-building{ z-index: 40 !important; }

/* ã‚¿ã‚³æ°‘ */
.map-wrap .takomin{ z-index: 60 !important; }

/* å¹ãå‡ºã—ã¯æœ€å‰ */
.map-wrap .takomin-balloon{ z-index: 80 !important; }

</style>

<!-- â–¼ ãƒœã‚¹ã‚²ãƒ¼ãƒˆ -->
<link rel="stylesheet" href="./assets/css/boss-local.css?v=1">

<!-- â–¼ ãŸã“ç„¼ãé‡£ã‚Š -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/takoyaki-trc/takoyaki-gate@4c8919c0a8740505f80998baea383a228b3bb847/takofish.css">

<!-- â–¼ ã‚¿ã‚¤ãƒˆãƒ«ä¸‹ã®ã‚¿ã‚³æ°‘ï¼•ï¼äººå›ã— -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/takoyaki-trc/takoyaki-gate@main/takomin-npc2.css?v=789">

<!-- â–¼ ãƒ›ãƒƒãƒˆã‚¹ãƒãƒƒãƒˆ -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/takoyaki-trc/takoyaki-gate@main/hotspot1.css?v=777">

<!-- â–¼ãŸã“ç„¼ãã®ç¥­å£‡ -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/takoyaki-trc/takoyaki-media@main/town/assets/saidan.css?v=1">

<!-- â–¼ã‚¿ã‚³æ°‘æ‘äººã‚»ãƒªãƒ• -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/takoyaki-trc/takoyaki-gate@main/takomin-murabito.css?v=777">

<!-- â–¼ ãŸã“ç„¼ããƒ•ã‚¡ãƒ¼ãƒ ï¼ˆå®ç®±è¡¨ç¤ºã®è¦‹ãŸç›®ã‚‚å«ã‚€ã®ã§ãƒˆãƒƒãƒ—ã§ã‚‚æ®‹ã™ï¼‰ -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/takoyaki-trc/takoyaki-media@main/town/assets/takofarm1.css?v=2">







<style>
/* ===== ãƒ•ãƒƒã‚¿ãƒ¼å†… ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒœãƒƒã‚¯ã‚¹ ===== */
#trcFooterDataBox{
  width: min(720px, 92%);
  margin: 14px auto 10px;
  padding: 12px 12px;
  border: 2px solid rgba(255,255,255,.22);
  border-radius: 14px;
  background: rgba(10,10,18,.55);
  backdrop-filter: blur(6px);
  box-shadow: 0 16px 50px rgba(0,0,0,.45);
  text-align: left;
}

#trcFooterDataBox .row{
  display:flex;
  flex-wrap:wrap;
  gap:10px;
  align-items:center;
  justify-content:space-between;
}

#trcFooterDataBox .title{
  display:flex;
  align-items:center;
  gap:8px;
  font-weight: 900;
  letter-spacing:.03em;
  color:#fff;
}

#trcFooterDataBox .dot{
  width:8px; height:8px;
  border-radius:999px;
  background: rgba(180,220,255,.85);
  box-shadow: 0 0 0 2px rgba(180,220,255,.18);
}

#trcFooterDataBox .desc{
  margin-top: 8px;
  font-size: 12px;
  line-height: 1.6;
  color: rgba(255,255,255,.76);
}

#trcFooterDataBox .btns{
  display:flex;
  flex-wrap:wrap;
  gap:8px;
}

#trcFooterDataBox .btn{
  border: 2px solid rgba(255,255,255,.30);
  background: rgba(255,255,255,.08);
  color:#fff;
  border-radius: 12px;
  padding: 10px 12px;
  font-weight: 900;
  letter-spacing: .03em;
  cursor:pointer;
  -webkit-tap-highlight-color: transparent;
  touch-action: manipulation;
  white-space: nowrap;
}

#trcFooterDataBox .btn.primary{
  background: linear-gradient(180deg, rgba(140,200,255,.22), rgba(255,255,255,.08));
  border-color: rgba(180,220,255,.55);
}

#trcFooterDataBox .btn:active{ transform: translateY(1px); }

@media (max-width:420px){
  #trcFooterDataBox{ padding: 10px 10px; }
  #trcFooterDataBox .btn{ padding: 9px 10px; font-size: 12px; }
}
</style>






















</head>

<body id="{block:IndexPage}shopTopPage{/block:IndexPage}{block:ItemPage}shopDetailPage{/block:ItemPage}" class="shop template">



<div id="phase-strip">
  <div id="phase-orb"></div>
</div>

<div class="page-center">

<!-- â–¼ ã‚¿ã‚¤ãƒˆãƒ«ç”»åƒ -->
<center><img
  src="https://ul.h3z.jp/h12u4pD5.gif"
  style="display:block;width:400px !important;height:auto !important;"
>
<img src="https://basefile.akamaized.net/takoyakitrc-base-shop/69613a78bcb90/mojiji.png">
</center>

<!-- ==========================================
  ã‚¿ã‚¤ãƒˆãƒ«ä¸‹ãƒ»ã‚¿ã‚³æ°‘è¡¨ç¤ºï¼ˆã‚¢ã‚¯ã‚»ã‚¹ã”ã¨ã«ãƒ©ãƒ³ãƒ€ãƒ ï¼‰
========================================== -->
<div id="takominArea" class="takomin-area">
  <div class="takomin-wrap">

    <!-- ã‚¿ã‚³æ°‘ -->
    <a id="takominLink" class="takomin-avatar" href="#" target="_blank" rel="noopener">
      <img id="takominImg" src="" alt="ã‚¿ã‚³æ°‘">
    </a>

    <!-- æ¨ªãƒ†ã‚­ã‚¹ãƒˆ -->
    <div class="takomin-text">
      <span id="takominLine">â€¦â€¦</span>
    </div>

  </div>
</div>
</div>
<!-- âœ… ãƒˆãƒ¼ã‚¹ãƒˆï¼ˆå®ç®±ãªã©ï¼šãƒˆãƒƒãƒ—ã§1å€‹ã ã‘ï¼‰ -->
<div class="tf-toast" aria-live="polite"></div>

<!-- âœ… è¡—ãƒãƒƒãƒ—ã®ãƒ©ãƒƒãƒ‘ãƒ¼ï¼ˆå®ç®±ã¯ã“ã®ä¸­ã«å‡ºã‚‹ï¼‰ -->
<div class="map-wrap" id="townMap" style="position:relative;">

 <a class="tf-building" href="./farm.html" aria-label="ãŸã“ç„¼ãç•‘ã¸"
   style="left:19.5%; top:99%; width:110px;">
  <img src="https://ul.h3z.jp/iF0mVDkG.png" alt="ãŸã“ç„¼ãç•‘ï¼ˆå»ºç‰©ï¼‰">
</a>

<a class="tf-building" href="./roten.html" aria-label="éœ²åº—ã¸"
   style="left:20%; top:93%; width:140px;">
  <img src="https://ul.h3z.jp/AFW27Fek.png" alt="éœ²åº—ï¼ˆå»ºç‰©ï¼‰">
</a>

<a class="tf-building" href="./zukan.html" aria-label="ã‚«ãƒ¼ãƒ‰å›³é‘‘ã¸"
   style="left:80%; top:96%; width:50px;">
  <img src="https://ul.h3z.jp/nJLgRZOL.png" alt="ã‚«ãƒ¼ãƒ‰å›³é‘‘ï¼ˆå»ºç‰©ï¼‰">
</a>




  <!-- å®ç®±ã¯ takofarm2.js ãŒã“ã“ã«è‡ªå‹•å‡ºæ²¡ã•ã›ã‚‹ -->

  <!-- ã“ã“ã‹ã‚‰ãŸã“ç„¼ãã®ç¥­å£‡ï¼ˆåç›Šç”¨ï¼‰ -->
  <!-- âœ… è¦‹ãŸç›®ï¼ˆç¥­å£‡ï¼‰ -->
  <button class="spot spot--gate" type="button" aria-label="ãŸã“ç„¼ãã‚²ãƒ¼ãƒˆï¼ˆè¦‹ãŸç›®ï¼‰">
    <!-- åœŸå°ï¼ˆé€šå¸¸é…ç½®ï¼šé«˜ã•ã‚’ä½œã‚‹ï¼‰ -->
    <img class="spot__base"
         src="https://ul.h3z.jp/DOpnGGIS.png"
         data-day="https://ul.h3z.jp/DOpnGGIS.png"
         data-night="https://ul.h3z.jp/RrfereXw.png"
         alt="ãŸã“ç„¼ãã®ç¥­å£‡">

    <!-- ä¸Šã«é‡ã­ã‚‹ï¼ˆã‚¢ã‚¤ã‚³ãƒ³ï¼‰ -->
    <img class="spot__icon" src="https://ul.h3z.jp/G9HOojAP.png" alt="è¡Œãå…ˆã‚¢ã‚¤ã‚³ãƒ³">
  </button>

  <!-- âœ… ã‚¿ãƒƒãƒ—åˆ¤å®šå°‚ç”¨ï¼ˆé€æ˜ãƒœã‚¿ãƒ³ï¼šã“ã‚ŒãŒâ€œåå¿œã®æœ¬ä½“â€ï¼‰ -->
  <button class="gate-hit" type="button" aria-label="ãŸã“ç„¼ãã‚²ãƒ¼ãƒˆï¼ˆã‚¿ãƒƒãƒ—åˆ¤å®šï¼‰"></button>

  <!-- âœ… ãƒ¯ãƒ³ã‚¯ãƒƒã‚·ãƒ§ãƒ³ï¼ˆãƒ¢ãƒ¼ãƒ€ãƒ«ï¼‰ -->
  <div id="gateModal" class="gate-modal" aria-hidden="true">
    <div class="gate-modal__panel" role="dialog" aria-modal="true" aria-labelledby="gateModalTitle">
      <img id="gateModalPhoto" class="gate-modal__photo" src="" alt="">
      <div class="gate-modal__body">
        <div id="gateModalTitle" class="gate-modal__title">ãŸã“ç„¼ãã‚²ãƒ¼ãƒˆ</div>
        <div id="gateModalDesc" class="gate-modal__desc"></div>

        <div class="gate-modal__btns">
          <button id="gateModalCancel" type="button" class="gate-modal__btn">ã‚„ã‚ã‚‹</button>
          <a id="gateModalGo" class="gate-modal__btn gate-modal__btn--go" href="#" target="_blank" rel="noopener">è¡Œã</a>
        </div>
      </div>
    </div>
  </div>

  <img
    class="map-img"
    src="https://ul.h3z.jp/0yeAj4R7.png"
    alt="èƒŒæ™¯"
    data-morning="https://ul.h3z.jp/D4jEiu5y.png"
    data-day="https://ul.h3z.jp/bHkJV3PU.png"
    data-night="https://ul.h3z.jp/EOmNLbDO.png"/>

  <!-- âœ… ãƒœã‚¹ã‚²ãƒ¼ãƒˆï¼ˆå¤œã ã‘è¡¨ç¤ºï¼†ã‚¿ãƒƒãƒ—ã§ãƒœã‚¹ä¼šè©±â†’ãƒãƒˆãƒ«ï¼‰ -->
  <a class="boss-gate night-only" href="#" aria-label="é‰„æ¿é­”ã‚°ãƒã«æŒ‘ã‚€">
    <img src="https://ul.h3z.jp/CsjyEnG3.png" alt="ãƒœã‚¹ã‚²ãƒ¼ãƒˆ">
  </a>

  <!-- â–¼ã‚¿ã‚³æ°‘ç¾¤ -->
  <!-- âœ… GHOST -->
  <button class="takomin takomin--ghost takomin--glow is-float" data-id="ghost" type="button" aria-label="GHOSTã®ã‚¿ã‚³æ°‘">
    <img src="https://ul.h3z.jp/yfWcFrT4.png"
      data-day="https://ul.h3z.jp/yfWcFrT4.png"
      data-night="https://ul.h3z.jp/93R4C9fH.png"
      alt="GHOST">
    <div class="takomin-balloon"></div>
  </button>

  <!-- âœ… YOUSHA -->
  <button class="takomin takomin--yousha takomin--glow" data-id="yousha" type="button" aria-label="YOUSHA">
    <img
      src="https://ul.h3z.jp/XNnElwbh.png"
      data-day="https://ul.h3z.jp/XNnElwbh.png"
      data-night="https://ul.h3z.jp/2LR6QUQf.png"
      alt="YOUSHA">
    <div class="takomin-balloon"></div>
  </button>

  <!-- âœ… è¿½åŠ ï¼šã‚‚ã¨ã®æ¹¯ï¼ˆãŸã“ç„¼ãèœã€…ï¼‰ -->
  <button class="takomin takomin--motoyu is-step takomin--glow" data-id="motoyu" type="button" aria-label="ãŸã“ç„¼ãèœã€…ï¼ˆã‚‚ã¨ã®æ¹¯ï¼‰ã®ã‚¿ã‚³æ°‘">
    <img
      src="https://ul.h3z.jp/vsy0pctI.png"
      data-day="https://ul.h3z.jp/vsy0pctI.png"
      data-night="https://ul.h3z.jp/PpSfLird.png"
      alt="ã‚‚ã¨ã®æ¹¯">
    <div class="takomin-balloon"></div>
  </button>

  <!-- âœ… kbc -->
  <button class="takomin takomin--kbc takomin--glow" data-id="kbc" type="button" aria-label="ä¹…ç•™ç±³ï¼«ï¼¢ï¼£">
    <img
      src="https://ul.h3z.jp/fy5i61XI.png"
      data-day="https://ul.h3z.jp/fy5i61XI.png"
      data-night="https://ul.h3z.jp/mGbOq0Q5.png"
      alt="ä¹…ç•™ç±³ï¼«ï¼¢ï¼£">
    <div class="takomin-balloon"></div>
  </button>

  <!-- âœ… katana -->
  <button class="takomin takomin--katana takomin--glow" data-id="katana" type="button" aria-label="åˆ€é›å†¶">
    <img
      src="https://ul.h3z.jp/OnsDTpd8.png"
      data-day="https://ul.h3z.jp/OnsDTpd8.png"
      data-night="https://ul.h3z.jp/KgDhxsxP.png"
      alt="åˆ€é›å†¶">
    <div class="takomin-balloon"></div>
  </button>

  <!-- âœ… hotel -->
  <button class="takomin takomin--hotel takomin--glow" data-id="hotel" type="button" aria-label="æ—…è·¯ã®å¡”">
    <img
      src="https://ul.h3z.jp/hx0gOm4a.png"
      data-day="https://ul.h3z.jp/hx0gOm4a.png"
      data-night="https://ul.h3z.jp/hx0gOm4a.png"
      alt="æ—…è·¯ã®å¡”">
    <div class="takomin-balloon"></div>
  </button>

  <!-- âœ…bigmans -->
  <button class="takomin takomin--bigmans takomin--glow" data-id="bigmans" type="button" aria-label="BIGMANS">
    <img
      src="https://ul.h3z.jp/sticAk2s.png"
      data-day="https://ul.h3z.jp/sticAk2s.png"
      data-night="https://ul.h3z.jp/q8H3THcE.png"
      alt="BIGMANS">
    <div class="takomin-balloon"></div>
  </button>

  <!-- âœ… 2bit -->
  <button class="takomin takomin--twobit takomin--glow" data-id="twobit" type="button" aria-label="twobit">
    <img
      src="https://basefile.akamaized.net/takoyakitrc-base-shop/696a673f108bf/2bit1.png"
      data-day="https://basefile.akamaized.net/takoyakitrc-base-shop/696a673f108bf/2bit1.png"
      data-night="https://basefile.akamaized.net/takoyakitrc-base-shop/696a6755c2e31/2bit2.png"
      alt="twobit">
    <div class="takomin-balloon"></div>
  </button>

  <!-- âœ… hanaya -->
  <button class="takomin takomin--hanaya takomin--glow" data-id="hanaya" type="button" aria-label="è¯çŸ¢å¼">
    <img
      src="https://ul.h3z.jp/JPKQZ6sP.png"
      data-day="https://ul.h3z.jp/JPKQZ6sP.png"
      data-night="https://ul.h3z.jp/yF9zSCHU.png"
      alt="è¯çŸ¢å¼">
    <div class="takomin-balloon"></div>
  </button>

  <!-- âœ… mars -->
  <button class="takomin takomin--mars takomin--glow" data-id="mars" type="button" aria-label="mars">
    <img
      src="https://ul.h3z.jp/n6sTv8Xr.png"
      data-day="https://ul.h3z.jp/n6sTv8Xr.png"
      data-night="https://ul.h3z.jp/tHlNh1NI.png"
      alt="mars">
    <div class="takomin-balloon"></div>
  </button>

  <!-- âœ… dollis -->
  <button class="takomin takomin--dollis takomin--glow" data-id="dollis" type="button" aria-label="ãƒ‰ãƒªã‚º">
    <img
      src="https://ul.h3z.jp/yi2Zbd3I.png"
      data-day="https://ul.h3z.jp/yi2Zbd3I.png"
      data-night="https://ul.h3z.jp/FmYMG8fu.png"
      alt="ãƒ‰ãƒªã‚º">
    <div class="takomin-balloon"></div>
  </button>

  <!-- âœ… punipuni -->
  <button class="takomin takomin--puni takomin--glow" data-id="puni" type="button" aria-label="ã·ã«ã·ã«">
    <img
      src="https://ul.h3z.jp/ujUBACrC.png"
      data-day="https://ul.h3z.jp/ujUBACrC.png"
      data-night="https://ul.h3z.jp/0LHkVmoQ.png"
      alt="ã·ã«ã·ã«">
    <div class="takomin-balloon"></div>
  </button>

  <!-- ä¸Šã®ãƒ–ãƒ­ãƒƒã‚¯ã‚¿ã‚³æ°‘ -->
  <button class="takomin takomin--me1 takomin--glow topmenu" data-id="me1" type="button" aria-label="æœ€æ–°ã®ãŠçŸ¥ã‚‰ã›">
    <img src="https://ul.h3z.jp/2z5fOkRX.png"
      data-day="https://ul.h3z.jp/2z5fOkRX.png"
      data-night="https://ul.h3z.jp/dUhJu7ky.png"
      alt="æœ€æ–°ã®ãŠçŸ¥ã‚‰ã›">
    <div class="takomin-balloon"></div>
  </button>

  <button class="takomin takomin--me2 takomin--glow topmenu" data-id="me2" type="button" aria-label="ãŸã“ç„¼ããƒˆãƒ¬ã‚«ã®ä¸–ç•Œ">
    <img src="https://ul.h3z.jp/CJ443Pa2.png"
      data-day="https://ul.h3z.jp/CJ443Pa2.png"
      data-night="https://ul.h3z.jp/QAszf1eo.png"
      alt="ãŸã“ç„¼ããƒˆãƒ¬ã‚«ã®ä¸–ç•Œ">
    <div class="takomin-balloon"></div>
  </button>

  <button class="takomin takomin--me3 takomin--glow topmenu" data-id="me3" type="button" aria-label="ã‚ˆãã‚ã‚‹è³ªå•">
    <img src="https://ul.h3z.jp/I3PLFgos.png"
      data-day="https://ul.h3z.jp/I3PLFgos.png"
      data-night="https://ul.h3z.jp/Qvk5pot0.png"
      alt="ã‚ˆãã‚ã‚‹è³ªå•">
    <div class="takomin-balloon"></div>
  </button>

  <button class="takomin takomin--me4 takomin--glow topmenu" data-id="me4" type="button" aria-label="ä»ŠéŠã¹ã‚‹ã‚¤ãƒ™ãƒ³ãƒˆ">
    <img src="https://ul.h3z.jp/y7MHJcs1.png"
      data-day="https://ul.h3z.jp/y7MHJcs1.png"
      data-night="https://ul.h3z.jp/HX7qBOFD.png"
      alt="ä»ŠéŠã¹ã‚‹ã‚¤ãƒ™ãƒ³ãƒˆ">
    <div class="takomin-balloon"></div>
  </button>

  <button class="takomin takomin--me5 takomin--glow topmenu" data-id="me5" type="button" aria-label="ãƒ“ãƒ³ã‚´ã®æ³‰">
    <img src="https://ul.h3z.jp/JQGm41Td.png"
      data-day="https://ul.h3z.jp/JQGm41Td.png"
      data-night="https://ul.h3z.jp/OrmSjUlC.png"
      alt="ãƒ“ãƒ³ã‚´ã®æ³‰">
    <div class="takomin-balloon"></div>
  </button>

  <button class="takomin takomin--me6 takomin--glow topmenu" data-id="me6" type="button" aria-label="ã‚«ãƒ¼ãƒ‰ã‚’è²·ã†">
    <img src="https://ul.h3z.jp/Db26pagb.png"
      data-day="https://ul.h3z.jp/Db26pagb.png"
      data-night="https://ul.h3z.jp/ko0Xgd8p.png"
      alt="ã‚«ãƒ¼ãƒ‰ã‚’è²·ã†">
    <div class="takomin-balloon"></div>
  </button>

  <button class="takomin takomin--me7 takomin--glow topmenu" data-id="me7" type="button" aria-label="ãŸã“ã´ã®SNS">
    <img src="https://ul.h3z.jp/D2KbpmcN.png"
      data-day="https://ul.h3z.jp/D2KbpmcN.png"
      data-night="https://ul.h3z.jp/g5bLMwI0.png"
      alt="ãŸã“ã´ã®SNS">
    <div class="takomin-balloon"></div>
  </button>

  <button class="takomin takomin--me8 takomin--glow topmenu" data-id="me8" type="button" aria-label="ã‚¢ã‚¤ãƒ†ãƒ ã‚·ãƒ§ãƒƒãƒ—">
    <img src="https://ul.h3z.jp/OREcMs5u.png"
      data-day="https://ul.h3z.jp/OREcMs5u.png"
      data-night="https://ul.h3z.jp/2gFRuuSs.png"
      alt="ã‚¢ã‚¤ãƒ†ãƒ ã‚·ãƒ§ãƒƒãƒ—">
    <div class="takomin-balloon"></div>
  </button>

  <button class="takomin takomin--me9 takomin--glow topmenu" data-id="me9" type="button" aria-label="é”æˆã®è¨˜éŒ²">
    <img src="https://ul.h3z.jp/nvhUJBFe.png"
      data-day="https://ul.h3z.jp/nvhUJBFe.png"
      data-night="https://ul.h3z.jp/gXNVqtcD.png"
      alt="é”æˆã®è¨˜éŒ²">
    <div class="takomin-balloon"></div>
  </button>

  <button class="takomin takomin--me10 takomin--glow topmenu" data-id="me10" type="button" aria-label="ãƒ¡ãƒ‡ã‚£ã‚¢æ²è¼‰">
    <img src="https://ul.h3z.jp/s4CIKhrn.png"
      data-day="https://ul.h3z.jp/s4CIKhrn.png"
      data-night="https://ul.h3z.jp/5fFm3Fpr.png"
      alt="ãƒ¡ãƒ‡ã‚£ã‚¢æ²è¼‰">
    <div class="takomin-balloon"></div>
  </button>

<button class="takomin takomin--me12 takomin--glow topmenu" data-id="me12" type="button" aria-label="ã‚«ãƒ¼ãƒ‰å›³é‘‘">
  <img src="https://ul.h3z.jp/Wvnf4dc7.png"
    data-day="https://ul.h3z.jp/Wvnf4dc7.png"
    data-night="https://ul.h3z.jp/3aj5G2CO.png"
    alt="">
  <div class="takomin-balloon"></div>
</button>


<button class="takomin takomin--me13 is-step" data-id="me13" type="button" aria-label="æ¨ã—æ´»">
  <img src="https://ul.h3z.jp/mC7LPEzu.png"
    data-day="https://ul.h3z.jp/mC7LPEzu.png"
    data-night="https://ul.h3z.jp/icyNwiaA.png"
    alt="æ¨ã—æ´»">
  <div class="takomin-balloon"></div>
</button>



<a class="takomin takomin--fish is-bob" href="#"
   onclick="window.openTakofishGame && window.openTakofishGame(); return false;">
  <img
    src="https://ul.h3z.jp/8taiJLpS.png"
    data-day="https://ul.h3z.jp/8taiJLpS.png"
    data-night="https://ul.h3z.jp/QP3AevlY.png"
    alt="é‡£ã‚Šã‚¿ã‚³æ°‘">
</a>

<style>/* ğŸ£ é‡£ã‚Šã‚¿ã‚³æ°‘ã®ä½ç½® */
.map-wrap .takomin--fish{
  top: 85.6%;
  left: 70%;
}
/* âœ… ã‚¿ãƒ¯ãƒ¼å…„å¦¹ã‚’ã‚¿ãƒ¯ãƒ¼ã‚ˆã‚Šä¸Šã«ï¼ˆæœ€çµ‚Fixï¼šä¸€ç•ªæœ€å¾Œã«ç½®ãï¼‰ */
.map-wrap .takomin--tawa1{
  position: absolute !important;
  z-index: 90 !important;   /* â† å…„å¦¹ã‚’æœ€å‰ã« */
}

.map-wrap .takomin--tawa{
  position: absolute !important;
  z-index: 80 !important;   /* â† ã‚¿ãƒ¯ãƒ¼ã¯å…„å¦¹ã®ä¸€æ®µä¸‹ */
}


</style>

<button class="takomin takomin--tawa1 takomin--glow topmenu" data-id="tawa1" type="button" aria-label="ã‚¿ãƒ¯ãƒ¼å…„å¦¹">
  <img src="https://basefile.akamaized.net/takoyakitrc-base-shop/6978ca4e7ec5c/sasada3.png"
    data-day="https://basefile.akamaized.net/takoyakitrc-base-shop/6978ca4e7ec5c/sasada3.png"
    data-night="https://ul.h3z.jp/xonP2u98.png"
    alt="ã‚¿ãƒ¯ãƒ¼å…„å¦¹">
  <div class="takomin-balloon"></div>
</button>


<!-- âœ… ãŸã“ç„¼ãã‚¿ãƒ¯ãƒ¼ï¼ˆèµ·å‹•ã‚¢ã‚¤ã‚³ãƒ³ï¼‰ -->
<button class="takomin takomin--tawa" data-id="tawa" type="button" aria-label="ãŸã“ç„¼ãã‚¿ãƒ¯ãƒ¼">
  <img
    src="https://ul.h3z.jp/QJX6Wqrs.png"
    data-day="https://ul.h3z.jp/QJX6Wqrs.png"
    data-night="https://ul.h3z.jp/Rbm88XCj.png"
    alt="ãŸã“ç„¼ãã‚¿ãƒ¯ãƒ¼">
  <div class="takomin-balloon"></div>
</button>

<script>
(() => {
  // =========================
  // 1) ãŸã“ç„¼ãã‚¿ãƒ¯ãƒ¼èµ·å‹•ï¼ˆé·ç§»ï¼‰
  // =========================
  const towerBtn = document.querySelector('.takomin--tawa');
  if (towerBtn) {
    towerBtn.addEventListener('click', () => {
      location.href = './takoyaki-tower.html';
    });
  }

  // =========================
  // 2) æ˜¼å¤œç”»åƒåˆ‡æ›¿
  // =========================
  const isNight = () =>
    document.documentElement.classList.contains("is-night") ||
    document.body?.classList.contains("is-night");

  // âœ… æ˜¼å¤œåˆ‡æ›¿ã—ãŸã„ç”»åƒã‚’è¿½åŠ 
  const targets = [
    ".takomin--tawa img",
    ".takomin--tawa1 img",
    ".takomin--fish img"
  ];

  function apply(){
    targets.forEach(sel => {
      const img = document.querySelector(sel);
      if (!img) return;

      const day   = img.dataset.day;
      const night = img.dataset.night;
      const url   = isNight() ? night : day;

      if (url) img.src = url;
    });
  }

  // åˆå›
  apply();

  // classå¤‰åŒ–ã§å³åæ˜ 
  const mo = new MutationObserver(apply);
  mo.observe(document.documentElement, { attributes:true, attributeFilter:["class"] });
  if (document.body) mo.observe(document.body, { attributes:true, attributeFilter:["class"] });

  // ï¼ˆä¿é™ºï¼‰ä»–JSãŒsrcã‚’ä¸Šæ›¸ãã™ã‚‹å ´åˆ
  setInterval(apply, 1000);
})();
</script>









<style>
/* =========================
   ğŸ™ ã‚¿ã‚³æ°‘ï¼ˆé‡ç”£ç”¨ï¼šå…±é€šï¼‰
   ========================= */
.map-wrap .takomin{
  position: absolute;
  transform: translate(-50%, -100%);
  width: clamp(56px, 6vw, 64px);
  z-index: 60;
  background: transparent;
  border: 0;
  padding: 0;
  cursor: pointer;
  -webkit-tap-highlight-color: transparent;
  touch-action: manipulation;
}

.map-wrap .takomin img{
  width: 100%;
  height: auto;
  display: block;
  image-rendering: pixelated;
}

/* âœ… å¹ãå‡ºã—ã‚’å¿…ãšç”»åƒã‚ˆã‚Šå‰ã«å‡ºã™ */
.map-wrap .takomin-balloon{
  position: absolute;
  bottom: 100%;
  left: 50%;
  transform: translateX(-50%);
  z-index: 999;            /* â†æœ€å‰é¢ */
  display: none;
  background: #000;
  color: #fff;
  padding: 8px 12px;
  border-radius: 6px;
  font-size: clamp(11px, 2.8vw, 14px);
  width: max-content;
  max-width: min(420px, 85vw);
  white-space: pre-line;
  line-height: 1.4;
  pointer-events: none;
}

/* å…„å¦¹ã‚’å‰ã« */
.takomin--tawa1{
  position: relative;
  z-index: 40 !important;
}

/* èµ·å‹•ã‚¢ã‚¤ã‚³ãƒ³ã¯ä¸€æ®µå¾Œã‚ */
.takomin--tawa{
  position: relative;
  z-index: 10 !important;
}


/* =========================
   ğŸ§­ ãƒˆãƒƒãƒ—ãƒ¡ãƒ‹ãƒ¥ãƒ¼ï¼ˆme1ã€œme12ï¼‰ã ã‘å°ã•ã
   - class="topmenu" ãŒä»˜ã„ãŸã‚‚ã®ã ã‘å¯¾è±¡
   - ä»–ã®å€‹åˆ¥ã‚µã‚¤ã‚ºæŒ‡å®šã‚ˆã‚Šå¿…ãšå„ªå…ˆ
   ========================= */
.map-wrap .takomin.topmenu{
  width: clamp(38px, 4.3vw, 48px) !important;
}

/* =========================
   ğŸ™ ç‰¹å¤§ã‚¿ã‚³æ°‘ï¼ˆå¿…è¦ãªã‚‚ã®ã ã‘å€‹åˆ¥ï¼‰
   ========================= */
.map-wrap .takomin[data-id="bigmans"]{
  width: clamp(86px, 10vw, 140px);
}

.map-wrap .takomin[data-id="twobit"]{
  width: clamp(60px, 10vw, 140px);
}

.map-wrap .takomin[data-id="me13"]{
  width: clamp(130px, 10vw, 140px);
}

.map-wrap .takomin[data-id="tawa"]{
  width: clamp(130px, 10vw, 200px);
}

.map-wrap .takomin[data-id="puni"]{
  width: clamp(60px, 10vw, 140px);
}

/* âœ… ç”»åƒãŒå›ºå®šã‚µã‚¤ã‚ºã®ã¾ã¾å•é¡Œã‚’æ½°ã™ */
button.takomin.takomin--tawa1 > img{
  width: 130% !important;
  height: 130% !important;
  max-width: none !important;
  max-height: none !important;
  display: block !important;
  object-fit: contain !important;
}


/* =========================
   ğŸ™ ã‚¿ã‚³æ°‘ï¼ˆé‡ç”£ç”¨ï¼šåº§æ¨™ï¼‰
   ========================= */
.map-wrap .takomin--me1{ top:5%; left:29%; }
.map-wrap .takomin--me2{ top:3%; left:70%; }
.map-wrap .takomin--me3{ top:12.7%; left:32%; }
.map-wrap .takomin--me4{ top:13%; left:70%; }
.map-wrap .takomin--me5{ top:20.5%; left:50%; }
.map-wrap .takomin--me6{ top:23%; left:37%; }
.map-wrap .takomin--me7{ top:21.4%; left:76%; }
.map-wrap .takomin--me8{ top:30.5%; left:39%; }
.map-wrap .takomin--me9{ top:29%; left:68%; }
.map-wrap .takomin--me10{ top:38.5%; left:30%; }
.map-wrap .takomin--me12{ top:38%; left:70%; }
.map-wrap .takomin--me13{ top:68.8%; left:52%; }
.map-wrap .takomin--tawa{ top:95%; left:50%; }
.map-wrap .takomin--tawa1{ top:95%; left:55%; }
.map-wrap .takomin--ghost{ top:72.9%; left:25%; }
.map-wrap .takomin--yousha{ top:65%; left:27%; }
.map-wrap .takomin--motoyu{ top:73%; left:50.8%; }
.map-wrap .takomin--kbc{ top:47.5%; left:75%; }
.map-wrap .takomin--katana{ top:47.3%; left:23%; }
.map-wrap .takomin--hotel{ top:58.4%; left:61%; }
.map-wrap .takomin--bigmans{ top:57.7%; left:24%; }
.map-wrap .takomin--twobit{ top:80%; left:25%; }
.map-wrap .takomin--hanaya{ top:65%; left:76%; }
.map-wrap .takomin--mars{ top:72.8%; left:77%; }
.map-wrap .takomin--dollis{ top:57.8%; left:75%; }
.map-wrap .takomin--puni{ top:80%; left:77%; }





/* å¤œã ã‘è¡¨ç¤ºåˆ¶å¾¡ï¼ˆbodyã« is-night ãŒä»˜ãå‰æï¼‰ */
.night-only{ display:none; }
html.is-night .night-only{ display:block; }






/* =========================
   ğŸ—º map-wrap ã‚’çµ¶å¯¾é…ç½®ã®åŸºæº–ã«ã™ã‚‹ï¼ˆé‡è¦ï¼‰
   ========================= */
.map-wrap{ position: relative; }

/* =========================
   ğŸ™ ã‚¿ã‚³æ°‘ï¼šå‹•ããƒ—ãƒªã‚»ãƒƒãƒˆ
   ========================= */

@keyframes takominFloat {
  0%,100% { transform: translateY(0); }
  50%     { transform: translateY(-3px); }
}

@keyframes takominBob {
  0%,100% { transform: translateY(0) rotate(0deg); }
  50%     { transform: translateY(-2px) rotate(-1deg); }
}

@keyframes takominShake {
  0%,100% { transform: translateX(0); }
  20%     { transform: translateX(-1px); }
  40%     { transform: translateX(1px); }
  60%     { transform: translateX(-1px); }
  80%     { transform: translateX(1px); }
}

/* âœ… åŸºæœ¬ï¼šãµã‚ãµã‚ï¼ˆå¸¸æ™‚ï¼‰ */
.map-wrap .takomin.is-float img{
  animation: takominFloat 1.8s ease-in-out infinite;
  will-change: transform;
}

/* âœ… ã‚‚ã†å°‘ã—â€œç”Ÿãç‰©æ„Ÿâ€ï¼ˆå¸¸æ™‚ï¼‰ */
.map-wrap .takomin.is-bob img{
  animation: takominBob 1.6s ease-in-out infinite;
  will-change: transform;
}

/* âœ… ã‚¿ãƒƒãƒ—ã—ãŸæ™‚ã ã‘éœ‡ãˆã‚‹ï¼ˆJSã§ä»˜ã‘å¤–ã—ï¼‰ */
.map-wrap .takomin.is-shake img{
  animation: takominShake .22s linear infinite;
  will-change: transform;
}

/* âœ… me13 ã¯ä»–ã®å¹ãå‡ºã—ã‚ˆã‚Šå¾Œã‚ã«å›ã™ï¼ˆã§ã‚‚åœŸå°ã‚ˆã‚Šã¯å‰ï¼‰ */
.map-wrap .takomin[data-id="me13"]{
  z-index: 45 !important; /* â† 40(ç¥­å£‡)ã‚ˆã‚Šä¸Š / 60(ä»–ã‚¿ã‚³æ°‘)ã‚ˆã‚Šä¸‹ */
}



/* =========================
   ğŸ™ ã‚¿ã‚³æ°‘ï¼šè¶³è¸ã¿ï¼ˆãƒˆã‚³ãƒˆã‚³ï¼‰
   ========================= */

@keyframes takominStep {
  0%   { transform: translateY(0); }
  25%  { transform: translateY(-1px); }
  50%  { transform: translateY(0); }
  75%  { transform: translateY(-1px); }
  100% { transform: translateY(0); }
}

/* âœ… å¸¸æ™‚è¶³è¸ã¿ */
.map-wrap .takomin.is-step img{
  animation: takominStep .6s steps(2) infinite;
  will-change: transform;
}

/* âœ… iPhoneå¯¾ç­–ï¼šå‹•ãã‚’æ¸›ã‚‰ã™è¨­å®šã®äººã«ã¯æ­¢ã‚ã‚‹ */
@media (prefers-reduced-motion: reduce){
  .map-wrap .takomin img{ animation: none !important; }
}

/* ã‚¿ã‚³æ°‘ã‚¢ã‚¤ã‚³ãƒ³ï¼ˆãƒœã‚¿ãƒ³ or imgï¼‰ã«ä»˜ã‘ã‚‹å…±é€šã‚¯ãƒ©ã‚¹ */
.takomin--glow img{
  /* ç”»åƒã®ç¸ã‚’å…‰ã‚‰ã›ã‚‹ï¼šé€æ˜PNGã§ã‚‚åŠ¹ã */
  filter:
    drop-shadow(0 0 2px rgba(255, 240, 150, 0.95))
    drop-shadow(0 0 6px rgba(255, 200, 80, 0.75))
    drop-shadow(0 0 14px rgba(255, 140, 20, 0.55));
}


@keyframes takominGlow{
  0%,100%{
    filter:
      drop-shadow(0 0 2px rgba(255,240,150,.85))
      drop-shadow(0 0 6px rgba(255,200,80,.55))
      drop-shadow(0 0 14px rgba(255,140,20,.35));
  }
  50%{
    filter:
      drop-shadow(0 0 3px rgba(255,255,200,.95))
      drop-shadow(0 0 10px rgba(255,210,120,.8))
      drop-shadow(0 0 22px rgba(255,160,60,.6));
  }
}
















/* âœ… ãƒœã‚¹ã‚²ãƒ¼ãƒˆï¼ˆç”»åƒãƒªãƒ³ã‚¯ï¼‰ */
.boss-gate{
  position:absolute;
  top: 41.3%;     /* â†èª¿æ•´ */
  left: 50%;      /* â†èª¿æ•´ */
  transform: translateX(-50%);
  width: 18%;     /* â†èª¿æ•´ */
  z-index: 12;
  display:block;
  cursor: pointer;
  -webkit-tap-highlight-color: transparent;
}

/* ç”»åƒãã®ã‚‚ã® */
.boss-gate img{
  width: 100%;
  height: auto;
  display:block;
  image-rendering: pixelated;
}

/* ï¼ˆä»»æ„ï¼‰å¤œã®ãƒœã‚¹æ„Ÿï¼šãµã‚ã£ã¨è„ˆå‹• */
html.is-night .boss-gate{
  animation: bossPulse 1.6s ease-in-out infinite;
}
@keyframes bossPulse{
  0%{ transform: translateX(-50%) scale(1);   opacity: 0.95; }
  50%{ transform: translateX(-50%) scale(1.04); opacity: 1; }
  100%{ transform: translateX(-50%) scale(1); opacity: 0.95; }
}

/* ===== ãƒœã‚¹ä¼šè©±ï¼ˆæˆ¦ã†å‰ï¼‰ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ ===== */
.boss-talk{
  position: fixed;
  inset: 0;
  display: none;
  z-index: 9998;
  background: rgba(0,0,0,0.78);
}
.boss-talk-panel{
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  width: min(420px, 90vw);
  padding: 14px 12px;
  border: 3px solid #fff;
  background: #000;
  color: #fff;
  font-family: system-ui, sans-serif;
}
.boss-talk-title{ font-size: 14px; margin-bottom: 8px; }
.boss-talk-text{
  font-size: 14px;
  line-height: 1.6;
  margin-bottom: 12px;
  min-height: 3.2em;
  opacity: 0.95;
}
.boss-talk-buttons{
  display: flex;
  gap: 8px;
  justify-content: center;
}
.boss-talk-buttons button{
  padding: 8px 10px;
  border: 2px solid #fff;
  background: #000;
  color: #fff;
  cursor: pointer;
}
.boss-talk-buttons button:active{ transform: translateY(1px); }

/* ===== ãƒãƒˆãƒ«çµæœã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ ===== */
.boss-overlay{
  position: fixed;
  inset: 0;
  display: none;
  z-index: 9999;
  background: rgba(0,0,0,0.78);
}
.boss-panel{
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  width: min(420px, 90vw);
  padding: 14px 12px;
  border: 3px solid #fff;
  background: #000;
  color: #fff;
  text-align: center;
  font-family: system-ui, sans-serif;
}
.boss-head{ font-size: 13px; opacity: 0.9; margin-bottom: 8px; }
.boss-name{ font-size: 16px; margin-bottom: 10px; }
.boss-cardframe{
  width: min(300px, 78vw);
  margin: 0 auto 10px;
  border: 2px solid #fff;
  padding: 8px;
  background: #111;
}
.boss-cardimg{
  width: 100%;
  height: auto;
  display: block;
  image-rendering: pixelated;
}
.boss-result{ font-size: 28px; letter-spacing: 2px; margin-top: 6px; }
.boss-score{ margin-top: 4px; font-size: 22px; }
.boss-comment{
  margin-top: 8px;
  font-size: 14px;
  line-height: 1.45;
  min-height: 2.8em;
  opacity: 0.95;
}
.boss-footer{ margin-top: 10px; font-size: 12px; opacity: 0.75; line-height: 1.4; }
.boss-buttons{
  display: flex;
  gap: 8px;
  justify-content: center;
  margin-top: 12px;
}
.boss-buttons button{
  padding: 8px 10px;
  border: 2px solid #fff;
  background: #000;
  color: #fff;
  cursor: pointer;
}
.boss-buttons button:active{ transform: translateY(1px); }




/* =========================
   å»ºç‰©ã®åº§æ¨™ã‚ºãƒ¬å®Œå…¨Fixï¼ˆæœ€å„ªå…ˆï¼‰
   â€» å¿…ãš style ã®ä¸€ç•ªæœ€å¾Œã«ç½®ã
========================= */

.map-wrap .tf-building{
  position:absolute !important;

  /* â† ã“ã‚ŒãŒä»Šå›ã®ã‚­ãƒ¢ï¼ˆä¸­å¿ƒï¼‹è¶³å…ƒåŸºæº–ï¼‰ */
  transform: translate(-50%, -100%) !important;
  transform-origin: 50% 100% !important;

  margin:0 !important;
  padding:0 !important;
}

.map-wrap .tf-building > img{
  display:block !important;
  width:100% !important;
  height:auto !important;
}

  

</style>















































  

  <!-- ãƒ€ãƒ¼ãƒ„ä½ä¿£ã¨ãƒ‹ã‚­ãƒ†ã‚£GIF -->
  <img src="https://ul.h3z.jp/l2zcjFAE.gif" class="map-gif" alt="ã‚³ãƒ©ãƒœã‚«ãƒ¼ãƒ‰ä¸€è¦§">

<!-- åŒ—æµ·é“ç„¼ãã‚‚ã¨ã®æ¹¯GIF -->
  <img src="https://ul.h3z.jp/OdXwiBmZ.gif" class="map2-gif" alt="ãŸã“ç„¼ãèœã€…">


  
  <!-- ãƒ›ãƒƒãƒˆã‚¹ãƒãƒƒãƒˆ -->
  <a class="hotspot hs-osirase" href="https://takoyaki-trc.github.io/takoyaki-media/town/news.html" aria-label="æœ€æ–°ã®ãŠçŸ¥ã‚‰ã›"></a>
  <a class="hotspot hs-story" href="https://takoyaki-trc.github.io/takoyaki-media/town/about.html" aria-label="ãŸã“ç„¼ããƒˆãƒ¬ã‚«ã®ä¸–ç•Œ"></a>
  <a class="hotspot hs-situmon" href="https://takoyaki-trc.github.io/takoyaki-media/town/faq.html" aria-label="ã‚ˆãã‚ã‚‹è³ªå•"></a>
  <a class="hotspot hs-bingo" href="https://takoyaki-trc.github.io/takoyaki-media/town/bingo.html" aria-label="ãƒ“ãƒ³ã‚´ã®æ³‰"></a>
   <a class="hotspot hs-ivent" href="https://takoyaki-trc.github.io/takoyaki-media/town/events.html" aria-label="ã„ã¾éŠã¹ã‚‹ã‚¤ãƒ™ãƒ³ãƒˆ"></a>
  <a class="hotspot hs-kau" href="https://takoyaki-toreka.booth.pm/item_lists/m7YToKe5" aria-label="ã‚«ãƒ¼ãƒ‰ã‚’è²·ã†"></a>
  <a class="hotspot hs-sns" href="https://x.com/takopi_trc" aria-label="ãŸã“ã´ã®SNS"></a>
  <a class="hotspot hs-item" href="https://takoyaki-toreka.booth.pm/item_lists/nNPTZdOd" aria-label="ã‚¢ã‚¤ãƒ†ãƒ ã‚·ãƒ§ãƒƒãƒ—"></a>
   <a class="hotspot hs-kiroku" href="https://takoyaki-trc.github.io/takoyaki-media/town/complete.html" aria-label="é”æˆã®è¨˜éŒ²"></a>
  <a class="hotspot hs-medhia" href="https://takoyaki-trc.github.io/takoyaki-media/town/media.html" aria-label="ãƒ¡ãƒ‡ã‚£ã‚¢æ²è¼‰"></a>
  <a class="hotspot hs-korabo" href="./collabo.html" aria-label="ã‚³ãƒ©ãƒœã‚«ãƒ¼ãƒ‰ã‚’è¦‹ã‚‹"></a>
  <a class="hotspot hs-zukan1" href="./cardlist.html" aria-label="ã‚«ãƒ¼ãƒ‰ãƒªã‚¹ãƒˆ"></a>
   <a class="hotspot hs-tou" href="https://takoyaki-trc.github.io/takoyaki-media/town/tabiji.html" aria-label="æ—…è·¯ã®å¡”"></a>


<!-- ãƒ›ãƒƒãƒˆã‚¹ãƒãƒƒãƒˆå”åŠ›åº—ã®è¡— -->
   <a class="hotspot hs-ghost" href="https://share.google/zXplullkNy8XP35bj" aria-label="GHOST"></a>
  <a class="hotspot hs-yousha" href="https://share.google/QAtxaPWvWBI4ks2Ug" aria-label="sports and darts cafe YOUSHA"></a>
  <a class="hotspot hs-bigmans"href="https://share.google/Ag1SRMedWINlgV0S3" aria-label="Darts&Shop BIGMANS"></a>
  <a class="hotspot hs-hanayashiki" href="https://share.google/AOSjhW79YMq0hJUuh" aria-label="è¯çŸ¢å¼"></a>
   <a class="hotspot hs-2bit" href="https://share.google/N2MqjpCLRYiKU6S8T" aria-label="Darts room 2 bit"></a>
  <a class="hotspot hs-kbc" href="https://share.google/6szp6CoWi6H6kL3Ss" aria-label="ãƒ“ãƒªãƒ¤ãƒ¼ãƒ‰ï¼†ãƒ€ãƒ¼ãƒ„ï¼«ï¼¢ï¼£"></a>
  <a class="hotspot hs-mars" href="https://share.google/Nu2j99ORbplos40Zh" aria-label="Mars. Kamata"></a>
<a class="hotspot hs-dollis" href="https://share.google/gb0NBa7q35HzEfqq9" aria-label="ãƒ€ãƒ¼ãƒ„ã‚«ãƒ•ã‚§ ãƒ‰ãƒªã‚º DOLLiS"></a>
  <a class="hotspot hs-puni" href="https://www.instagram.com/punipuni_wakkanai/" aria-label="ã·ã«ã·ã«ç¨šå†…"></a>
  <a class="hotspot hs-katanakazi" href="https://share.google/ulEVNRsi6wreMqV8p" aria-label="ãŸã“ç„¼ã åˆ€é›å†¶"></a>
   <a class="hotspot hs-nana" href="https://share.google/MDaHozOZI1bmLxUwL" aria-label="ãŸã“ç„¼ãèœã€…"></a>


  
</div>








<style>
/* night-only ã¯ is-night ã«åˆã‚ã›ã‚‹ï¼ˆã“ã“ã¯æ®‹ã—ã¦OKï¼‰ */
.night-only{ display:none; }

</style>

<script>
(() => {
  /* ===== Tokyo time (å…¨ã¦ã“ã‚ŒåŸºæº–) ===== */
  function nowTokyo(){
    return new Date(new Date().toLocaleString("en-US", { timeZone: "Asia/Tokyo" }));
  }

  /* ===== ãƒãƒƒãƒ—åˆ‡æ›¿ ===== */
  function slotByHour(h){
    if(h >= 5 && h < 11) return "morning";
    if(h >= 11 && h < 20) return "day";
    return "night";
  }
  function applyMapByHour(h){
    const img = document.querySelector('.map-img');
    if(!img) return;

    const slot = slotByHour(h);
    const url =
      slot === 'morning' ? img.dataset.morning :
      slot === 'day'     ? img.dataset.day :
                           img.dataset.night;

    if(url && img.src !== url) img.src = url;
  }

  /* ===== ç©ºã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ ===== */
  const SKY = [
    ["#0b1020", "#141c2e"], ["#0b1020", "#141c2e"],
    ["#0c1224", "#18223a"], ["#121a33", "#22304f"],
    ["#1b2a44", "#3b4a6b"], ["#3c3b5a", "#7b6ea8"],
    ["#8a5a7b", "#f2b5c4"], ["#d97b6a", "#ffd1a9"],
    ["#8ec1e8", "#eaf4ff"], ["#6fa8dc", "#cfe8ff"],
    ["#63a4e1", "#dbeeff"], ["#76b5ea", "#eaf4ff"],
    ["#87b8e5", "#eaf4ff"], ["#87b8e5", "#eaf4ff"],
    ["#7fb3d5", "#eaf4f4"], ["#9fc5d1", "#eaf4f4"],
    ["#f9cb9c", "#fff1c1"], ["#f2a65a", "#f6d365"],
    ["#d96c4f", "#f2a65a"], ["#a35d7b", "#5b4e7a"],
    ["#2c2f4a", "#1b2430"], ["#1b2430", "#141c2e"],
    ["#121a2b", "#10131f"], ["#0b1020", "#141c2e"]
  ];

  const mix = (a,b,t)=>{
    const h=x=>parseInt(x,16);
    const r=x=>x.toString(16).padStart(2,"0");
    const A=a.slice(1).match(/../g).map(h);
    const B=b.slice(1).match(/../g).map(h);
    return "#"+A.map((v,i)=>r(Math.round(v+(B[i]-v)*t))).join("");
  };

  /* ===== å¤ªé™½ï¼æœˆ ===== */
  function updatePhaseOrb(now){
    const strip = document.getElementById("phase-strip");
    const orb   = document.getElementById("phase-orb");
    if(!strip || !orb) return;

    const minutes = now.getHours()*60 + now.getMinutes();
    const sunrise = 6*60;
    const sunset  = 19*60;
    const nextSunrise = 24*60 + sunrise;

    let p, isDay;
    if(minutes >= sunrise && minutes < sunset){
      isDay = true;
      p = (minutes - sunrise) / (sunset - sunrise);
    }else{
      isDay = false;
      const m = minutes < sunrise ? minutes + 1440 : minutes;
      p = (m - sunset) / (nextSunrise - sunset);
    }

    const maxX = strip.clientWidth - orb.clientWidth;
    orb.style.transform =
      `translateX(${Math.round(maxX * p)}px) scale(${isDay ? 1 : 0.8})`;

    orb.classList.toggle("sun", isDay);
    orb.classList.toggle("moon", !isDay);

    if(!isDay){
      const sx = Math.round(26 - 52 * p);
      orb.style.setProperty("--shadow-x", `${sx}px`);
    }else{
      orb.style.removeProperty("--shadow-x");
    }
  }

  /* ===== ã¾ã¨ã‚ã¦åæ˜  ===== */
  function applyAll(){
    const now = nowTokyo();
    const h = now.getHours();
// å¤œåˆ¤å®šï¼ˆãƒœã‚¹ç”¨ã« is-night ã¸çµ±ä¸€ï¼‰
const night = (h >= 20 || h < 5);

const html = document.documentElement;

if (night) {
  html.classList.add("is-night");
  html.classList.remove("day");
} else {
  html.classList.remove("is-night");
  html.classList.add("day");
}

    // ãƒãƒƒãƒ—åˆ‡æ›¿
    applyMapByHour(h);

    // ç©ºã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆåˆ†å˜ä½ã§ãªã‚ã‚‰ã‹ï¼‰
    const t = (now.getMinutes()*60 + now.getSeconds()) / 3600;
    const next = (h+1)%24;
    document.body.style.setProperty(
      "--sky",
      `linear-gradient(${mix(SKY[h][0],SKY[next][0],t)}, ${mix(SKY[h][1],SKY[next][1],t)})`
    );

    // å¤ªé™½/æœˆ
    updatePhaseOrb(now);
  }

  document.addEventListener("DOMContentLoaded", ()=>{
    applyAll();
    setInterval(applyAll, 20 * 1000);
  });
  window.addEventListener("pageshow", applyAll);
})();
</script>





<script defer src="https://cdn.jsdelivr.net/gh/takoyaki-trc/takoyaki-gate@main/takomin-npc2.js?v=111"></script>


<script defer src="./assets/boss1.js?v=2"></script>


<script defer src="https://cdn.jsdelivr.net/gh/takoyaki-trc/takoyaki-gate@main/gate4.js?v=5"></script>

<script defer src="https://cdn.jsdelivr.net/gh/takoyaki-trc/takoyaki-gate@main/takomin-murabito7.js?v=5"></script>



<script defer src="https://cdn.jsdelivr.net/gh/takoyaki-trc/takoyaki-gate@main/takofish11.js?v=2"></script>


<!-- â–¼ GitHubï¼ˆjsDelivrï¼‰ã‹ã‚‰JSèª­ã¿è¾¼ã¿ï¼ˆdeferæ¨å¥¨ï¼‰ -->
<script defer src="./assets/takofarm3.js?v=20260129a"></script>







<footer id="siteFooter" style="
  width:100%;
  margin: 10px auto 0;
  padding: 10px 10px calc(18px + env(safe-area-inset-bottom));
  box-sizing:border-box;
  text-align:center;
  color: rgba(255,255,255,.78);
  font-size: 12px;
  line-height: 1.6;
">



<div id="trcFooterDataBox" aria-label="ãƒ‡ãƒ¼ã‚¿ã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã¨å¾©å…ƒ">
  <div class="row">
    <div class="title"><span class="dot"></span>DATAï¼ˆç«¯æœ«ä¿å­˜ï¼‰</div>
    <div class="btns">
      <button id="trcFooterBackup" class="btn primary" type="button">ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—</button>
      <button id="trcFooterRestore" class="btn" type="button">å¾©å…ƒ</button>
      <input id="trcFooterRestoreFile" type="file" accept="application/json" style="display:none">
    </div>
  </div>

 <div class="desc" style="
  color:#ff6b6b;
  font-weight:700;
  line-height:1.5;
">
  âš  é‡è¦ï¼šã“ã®ã‚²ãƒ¼ãƒ ã®ãƒ‡ãƒ¼ã‚¿ã¯ç«¯æœ«ã®ãƒ–ãƒ©ã‚¦ã‚¶ã«ã®ã¿ä¿å­˜ã•ã‚Œã¦ã„ã¾ã™ã€‚
  ã‚­ãƒ£ãƒƒã‚·ãƒ¥å‰Šé™¤ï½¥å±¥æ­´å‰Šé™¤ï½¥æ©Ÿç¨®å¤‰æ›´ã‚’è¡Œã†ã¨ã€<br>
  ã‚«ãƒ¼ãƒ‰ç”»åƒï½¥ã‚²ãƒ¼ãƒ é€²è¡Œï½¥ã‚ªã‚¯ãƒˆãªã©ã®ãƒ‡ãƒ¼ã‚¿ã¯ã™ã¹ã¦æ¶ˆãˆã¾ã™ã€‚<br>

  ãƒ‡ãƒ¼ã‚¿ã¯ã‚µãƒ¼ãƒãƒ¼ã«ä¿å­˜ã•ã‚Œã¾ã›ã‚“ã€‚å¾©æ—§ã‚‚ã§ãã¾ã›ã‚“ã€‚<br>
  å¿…ãšäº‹å‰ã«ã€Œãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã€ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚<br>

  â€»å¾©å…ƒã¯ç¾åœ¨ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä¸Šæ›¸ãã—ã¾ã™ã€‚å…ƒã«ã¯æˆ»ã›ã¾ã›ã‚“ã€‚
</div>
</div>







  
  <div style="display:flex;flex-wrap:wrap;gap:10px;justify-content:center;align-items:center;margin-bottom:10px;">
    <a href="./tokushoho.html" style="color:#fff;text-decoration:none;border-bottom:1px solid rgba(255,255,255,.35);padding-bottom:1px;">ç‰¹å®šå•†å–å¼•æ³•ã«åŸºã¥ãè¡¨è¨˜</a>
    <a href="./privacy.html" style="color:#fff;text-decoration:none;border-bottom:1px solid rgba(255,255,255,.35);padding-bottom:1px;">ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼</a>
    <a href="./terms.html" style="color:#fff;text-decoration:none;border-bottom:1px solid rgba(255,255,255,.35);padding-bottom:1px;">åˆ©ç”¨è¦ç´„ / å…è²¬</a>
    <a href="./contact.html" style="color:#fff;text-decoration:none;border-bottom:1px solid rgba(255,255,255,.35);padding-bottom:1px;">ãŠå•ã„åˆã‚ã›</a>
  </div>

 
  <div style="opacity:.75;margin-bottom:8px;">
    â€»ç”»åƒï½¥æ–‡ç« ã®ç„¡æ–­è»¢è¼‰ã‚’ç¦æ­¢ã—ã¾ã™ã€‚
  </div>

  <div style="opacity:.9;">
    Â© ãŸã“ç„¼ãèœã€… / ç„¼ã‹ã‚ŒãŸä¼èª¬ ãŸã“ç„¼ããƒˆãƒ¬ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚«ãƒ¼ãƒ‰
  </div>








  
</footer>





<script>
(() => {
  "use strict";

  // ===== ä¸»è¦ã‚­ãƒ¼ï¼ˆå¿…è¦ãªã‚‰ã“ã“ã ã‘å¢—ã‚„ã›ã‚‹ï¼‰ =====
  const KEY = {
    resident: "trc_v1_resident",
    lastLogin: "trc_v1_last_login",
  };
  const EXIST = {
    farmBook: "tf_v1_book",
    farmInv:  "tf_v1_inv",
    rotenOcto:"roten_v1_octo",
    tower: "tower_v1_state",
    fish:  "fish_v1_state",
  };

  // ===== utils =====
  const getRaw = (k) => {
    const v = localStorage.getItem(k);
    return (v === null || v === undefined) ? null : String(v);
  };
  const safeJSONParse = (raw, fallback) => { try { return JSON.parse(raw); } catch (_) { return fallback; } };
  const safeStringify = (obj) => { try { return JSON.stringify(obj); } catch (_) { return "null"; } };

  function listKeysByRegex(re) {
    const out = [];
    for (let i = 0; i < localStorage.length; i++) {
      const k = localStorage.key(i);
      if (!k) continue;
      if (re.test(k)) out.push(k);
    }
    return out;
  }

  // ===== å›³é‘‘slimï¼ˆcount+imgç­‰ï¼‰ =====
  function slimBookRawKeepImg() {
    const raw = getRaw(EXIST.farmBook);
    if (!raw) return null;

    const book = safeJSONParse(raw, null);
    if (!book || typeof book !== "object") return raw;

    const got = (book.got && typeof book.got === "object") ? book.got : {};
    const outGot = {};
    for (const id of Object.keys(got)) {
      const node = got[id] || {};
      const c = Number(node.count || 0);
      if (c > 0) {
        const out = { id, count: c };
        if (typeof node.img === "string" && node.img.trim()) out.img = node.img.trim();
        if (typeof node.name === "string" && node.name.trim()) out.name = node.name.trim();
        if (typeof node.rarity === "string" && node.rarity.trim()) out.rarity = node.rarity.trim();
        if (node.at != null && String(node.at).trim()) out.at = node.at;
        if (node.lastAt != null && String(node.lastAt).trim()) out.lastAt = node.lastAt;
        outGot[id] = out;
      }
    }
    const slim = { ver: book.ver ?? 1, got: outGot };
    return safeStringify(slim);
  }

  function findFarmProgressKeys() {
    const out = [];
    for (let i = 0; i < localStorage.length; i++) {
      const k = localStorage.key(i);
      if (!k) continue;
      if (!/^tf_v1_/i.test(k)) continue;
      if (/log|history|debug/i.test(k)) continue;
      if (k === EXIST.farmBook || k === EXIST.farmInv) continue;
      out.push(k);
    }
    const prefer = ["tf_v1_state","tf_v1_level","tf_v1_xp","tf_v1_farm","tf_v1_progress"];
    const ordered = [];
    for (const p of prefer) {
      if (localStorage.getItem(p) != null && !ordered.includes(p)) ordered.push(p);
    }
    for (const k of out) if (!ordered.includes(k)) ordered.push(k);
    return ordered.slice(0, 40);
  }

  function findRotenProgressKeys() {
    const out = [];
    for (let i = 0; i < localStorage.length; i++) {
      const k = localStorage.key(i);
      if (!k) continue;
      if (!/^roten_v1_/i.test(k)) continue;
      if (/log|history|debug/i.test(k)) continue;
      out.push(k);
    }
    const prefer = [
      "roten_v1_level","roten_v1_rep","roten_v1_myshop","roten_v1_inventory",
      "roten_v1_market","roten_v1_state","roten_v1_shelves","roten_v1_octo"
    ];
    const ordered = [];
    for (const p of prefer) {
      if (localStorage.getItem(p) != null && !ordered.includes(p)) ordered.push(p);
    }
    for (const k of out) if (!ordered.includes(k)) ordered.push(k);
    return ordered.slice(0, 90);
  }

  function buildSlimBackupPayload() {
    const keys = {};

    keys[KEY.resident] = getRaw(KEY.resident);
    keys[KEY.lastLogin] = getRaw(KEY.lastLogin);

    keys[EXIST.rotenOcto] = getRaw(EXIST.rotenOcto);
    keys[EXIST.farmInv]   = getRaw(EXIST.farmInv);
    keys[EXIST.farmBook]  = slimBookRawKeepImg();

    for (const k of findFarmProgressKeys()) {
      const v = getRaw(k);
      if (v != null) keys[k] = v;
    }
    for (const k of findRotenProgressKeys()) {
      const v = getRaw(k);
      if (v != null) keys[k] = v;
    }

    if (getRaw(EXIST.tower) != null) keys[EXIST.tower] = getRaw(EXIST.tower);
    for (const k of listKeysByRegex(/tower/i)) {
      const v = getRaw(k);
      if (v != null) keys[k] = v;
    }

    if (getRaw(EXIST.fish) != null) keys[EXIST.fish] = getRaw(EXIST.fish);
    for (const k of listKeysByRegex(/fish|takofish|tako_fish|tfish/i)) {
      const v = getRaw(k);
      if (v != null) keys[k] = v;
    }

    for (const k of Object.keys(keys)) {
      if (keys[k] === null || keys[k] === undefined) delete keys[k];
    }

    return {
      app: "takoyaki-trc",
      ver: 5,
      kind: "slim+roten",
      exportedAt: new Date().toISOString(),
      note: "ä½æ°‘ç¥¨/ã‚ªã‚¯ãƒˆ/è³‡æ/å›³é‘‘(count+img+id)/ç•‘é€²è¡Œ(tf_v1_*)/éœ²åº—é€²è¡Œ(roten_v1_*)/ã‚¿ãƒ¯ãƒ¼/é‡£ã‚Š ã‚’ä¿å­˜ã€‚ãƒ­ã‚°ã¯ä¿å­˜ã—ãªã„ã€‚",
      keys
    };
  }

  function downloadJson(obj, filename) {
    const blob = new Blob([JSON.stringify(obj, null, 2)], { type: "application/json" });
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = filename;
    document.body.appendChild(a);
    a.click();
    a.remove();
    URL.revokeObjectURL(url);
  }

  function backupSlim() {
    const payload = buildSlimBackupPayload();
    const stamp = new Date().toISOString().replace(/[:.]/g, "-");
    downloadJson(payload, `takoyaki-trc-backup_${stamp}.json`);
  }

  async function restoreFromFile(file) {
    const text = await file.text();
    const data = safeJSONParse(text, null);

    if (!data || !data.keys || typeof data.keys !== "object") {
      alert("ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—å½¢å¼ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚");
      return;
    }

    const keys = Object.keys(data.keys);
    const ok = confirm(
      "ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‹ã‚‰å¾©å…ƒã—ã¾ã™ã€‚\n" +
      "ç¾åœ¨ã®ãƒ‡ãƒ¼ã‚¿ã¯ä¸Šæ›¸ãã•ã‚Œã¾ã™ï¼ˆå…ƒã«æˆ»ã›ã¾ã›ã‚“ï¼‰ã€‚\n\n" +
      `å¾©å…ƒã‚­ãƒ¼æ•°: ${keys.length}\n` +
      `æ›¸ãå‡ºã—æ—¥æ™‚: ${String(data.exportedAt || "")}\n\n` +
      "ç¶šè¡Œã—ã¾ã™ã‹ï¼Ÿ"
    );
    if (!ok) return;

    for (const k of keys) {
      const v = data.keys[k];
      if (v === null || v === undefined) localStorage.removeItem(k);
      else localStorage.setItem(k, String(v));
    }

    alert("å¾©å…ƒã—ã¾ã—ãŸã€‚ãƒšãƒ¼ã‚¸ã‚’å†èª­ã¿è¾¼ã¿ã—ã¾ã™ã€‚");
    location.reload();
  }

  // ===== UI wiringï¼ˆãƒ•ãƒƒã‚¿ãƒ¼ç‰ˆï¼‰ =====
  const btnBackup  = document.getElementById("trcFooterBackup");
  const btnRestore = document.getElementById("trcFooterRestore");
  const inp        = document.getElementById("trcFooterRestoreFile");

  if (!btnBackup || !btnRestore || !inp) return;

  btnBackup.addEventListener("click", () => {
    const normal = btnBackup.textContent;
    btnBackup.disabled = true;
    btnBackup.textContent = "ä½œæˆä¸­â€¦";
    setTimeout(() => {
      try { backupSlim(); }
      finally {
        btnBackup.disabled = false;
        btnBackup.textContent = normal;
      }
    }, 50);
  });

  btnRestore.addEventListener("click", () => {
    inp.click();
  });

  inp.addEventListener("change", async () => {
    const f = inp.files && inp.files[0];
    inp.value = "";
    if (!f) return;

    const normal = btnRestore.textContent;
    btnRestore.disabled = true;
    btnRestore.textContent = "èª­è¾¼ä¸­â€¦";
    try { await restoreFromFile(f); }
    finally {
      btnRestore.disabled = false;
      btnRestore.textContent = normal;
    }
  });

})();
</script>




  
  
</body>
</html>
