<!-- =========================================================
     farm.htmlï¼ˆãŸã“ç„¼ãç•‘ï¼šãƒšãƒ¼ã‚¸ç‰ˆï¼‰
     - index(è¡—)ã‹ã‚‰ farm.html ã«é·ç§»ã—ã¦éŠã¶æƒ³å®š
     - CSS: takofarm.cssï¼ˆã‚ãªãŸã®ã‚„ã¤ï¼‰ã‚’èª­ã¿è¾¼ã‚€
     - JS : takofarm.jsï¼ˆã‚ãªãŸã®ã‚„ã¤ï¼‰ã‚’èª­ã¿è¾¼ã‚€
     - âœ… é‡è¦ï¼šJSãŒå‚ç…§ã™ã‚‹IDã‚’ã“ã®HTMLã§å…¨éƒ¨ç”¨æ„ã—ã¦ã„ã‚‹
     - å›³é‘‘ã¯ã€Œãƒ¢ãƒ¼ãƒ€ãƒ«ã€ã§é–‹ãï¼ˆè»½ã„/åˆ†é›¢ã—ã‚„ã™ã„ï¼‰
========================================================= -->
<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ãŸã“ç„¼ãç•‘ | ãŸã“ç„¼ããƒˆãƒ¬ã‚«</title>

  <!-- âœ… å…±æœ‰CSSï¼ˆã‚ãªãŸã®takofarm.cssï¼‰ -->
  <link rel="stylesheet" href="./takofarm.css">
  <style>
    /* ãƒšãƒ¼ã‚¸ç‰ˆã®æœ€ä½é™ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆï¼ˆé‡ãã—ãªã„ï¼‰ */
    body{
      margin:0;
      background:#070b10;
      color:#e8eef7;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans JP", sans-serif;
    }
    .tf-page{
      max-width: 980px;
      margin: 0 auto;
      padding: 14px 12px 90px;
    }
    .tf-topbar{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      margin-bottom:10px;
    }
    .tf-topbar__left{
      display:flex;
      align-items:center;
      gap:10px;
      min-width:0;
    }
    .tf-titlepage{
      font-weight:900;
      font-size:14px;
      margin:0;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .tf-back{
      text-decoration:none;
      display:inline-flex;
      align-items:center;
      gap:6px;
      padding:8px 10px;
      border:1px solid rgba(255,255,255,.12);
      border-radius:12px;
      color:#e8eef7;
      background:rgba(255,255,255,.04);
    }
    .tf-back:active{ transform: translateY(1px); }

    /* å›³é‘‘ãƒ¢ãƒ¼ãƒ€ãƒ«ï¼šãƒšãƒ¼ã‚¸ç‰ˆã§ã‚‚ä½¿ã† */
    .tf-modal{ z-index: 99990; }
  </style>
</head>

<body>
  <div class="tf-page">

    <!-- ä¸Šéƒ¨ï¼šæˆ»ã‚‹ï¼‹ã‚¿ã‚¤ãƒˆãƒ« -->
    <div class="tf-topbar">
      <div class="tf-topbar__left">
        <a class="tf-back" href="./index.html" aria-label="è¡—ã«æˆ»ã‚‹">â† è¡—ã«æˆ»ã‚‹</a>
        <h1 class="tf-titlepage">ãŸã“ç„¼ãç•‘ï¼ˆ3Ã—3ï¼‰</h1>
      </div>

      <!-- å³ä¸Šï¼šå›³é‘‘ãƒœã‚¿ãƒ³ï¼ˆãƒ¢ãƒ¼ãƒ€ãƒ«ï¼‰ -->
      <button id="openDex" class="tf-btn" type="button">å›³é‘‘</button>
    </div>

    <!-- HUD -->
    <div class="tf-hud" style="margin-bottom:10px;">
      <span class="tf-pill">ğŸª™ OCTOï¼š<b id="tfOcto">0</b></span>
      <span class="tf-pill">ğŸŒ± ç¨®ï¼š<b id="tfSeedCount">0</b></span>
      <span class="tf-pill">ğŸª¨ é»’ã„åŒ–çŸ³ï¼š<b id="tfFossilCount">0</b></span>

      <div class="tf-hud__right">
        <button id="tfHarvestStartBtn" class="tf-btn tf-btn--good" type="button">
          ä»Šæ—¥ã®åç©«ã‚¿ã‚¤ãƒ é–‹å§‹ï¼ˆ24hï¼‰
        </button>
        <button id="tfOpenShopWater" class="tf-btn" type="button">æ°´ã‚’è²·ã†</button>
        <button id="tfOpenShopTaco" class="tf-btn" type="button">ã‚¿ã‚³ã‚’è²·ã†</button>
        <button id="tfResetBtn" class="tf-btn tf-btn--danger" type="button">åˆæœŸåŒ–</button>
      </div>
    </div>

    <div class="tf-farm">
      <!-- å·¦ï¼šç›¤é¢ -->
      <div class="tf-farm__left">
        <div class="tf-card">
          <div class="tf-title">é‰„æ¿ï¼ˆ3Ã—3ï¼‰</div>
          <div id="tfPlate" class="tf-plate"></div>
          <div class="tf-mini" style="margin-top:8px;">
            æˆé•·ï¼š24h â†’ åç©«å¯èƒ½ï¼ˆ24hï¼‰ â†’ æ”¾ç½®ã§ç„¦ã’æ¶ˆå¤±ï¼ˆ3%ã§é»’ã„åŒ–çŸ³ï¼‰
          </div>
        </div>
      </div>

      <!-- å³ï¼šæ“ä½œ -->
      <div class="tf-farm__right">
        <div class="tf-card">
          <div class="tf-title">é¸æŠãƒã‚¹</div>
          <div style="display:flex; gap:8px; flex-wrap:wrap; margin-bottom:10px;">
            <span class="tf-pill">ãƒã‚¹ï¼š<b id="tfSelIndex">-</b></span>
            <span class="tf-pill">çŠ¶æ…‹ï¼š<b id="tfSelState">-</b></span>
          </div>

          <div class="tf-actions">
            <div class="tf-actions__row">
              <button id="tfPlantBtn" class="tf-btn tf-btn--primary" type="button">ç¨®ã‚’æ¤ãˆã‚‹</button>
              <button id="tfCancelBtn" class="tf-btn tf-btn--ghost" type="button">ã‚­ãƒ£ãƒ³ã‚»ãƒ«ï¼ˆç¨®æˆ»ã‚‹ï¼‰</button>
            </div>

            <div class="tf-actions__row">
              <select id="tfPickWater" class="tf-select" aria-label="æ°´ã‚’é¸ã¶"></select>
            </div>

            <div class="tf-actions__row">
              <select id="tfPickTaco" class="tf-select" aria-label="ã‚¿ã‚³ã‚’é¸ã¶"></select>
            </div>

            <div class="tf-actions__row">
              <button id="tfHarvestBtn" class="tf-btn tf-btn--good" type="button">ã“ã®ãƒã‚¹ã‚’åç©«ã™ã‚‹</button>
            </div>

            <div id="tfActionMsg" class="tf-actions__msg">ãƒã‚¹ã‚’ã‚¿ãƒƒãƒ—ã—ã¦é¸ã‚“ã§ãã ã•ã„ã€‚</div>
          </div>
        </div>

        <!-- å³ä¸‹ï¼šã¡ã‚‡ã„èª¬æ˜ -->
        <div class="tf-card">
          <div class="tf-title">ãƒ’ãƒ³ãƒˆ</div>
          <div class="tf-mini" style="line-height:1.6;">
            ãƒ»ç¨®ã¯è¡—ã®å®ç®±ã§æ‰‹ã«å…¥ã‚‹ã€‚<br>
            ãƒ»æ°´â†’ã‚¿ã‚³ã§ç¢ºå®šã—ã¦ç„¼ãå§‹ã‚ã‚‹ã€‚<br>
            ãƒ»åç©«ã™ã‚‹ã«ã¯ã€Œä»Šæ—¥ã®åç©«ã‚¿ã‚¤ãƒ é–‹å§‹ã€ãŒå¿…è¦ã€‚<br>
            ãƒ»æ”¾ç½®ã™ã‚‹ã¨ç„¦ã’ã¦æ¶ˆãˆã‚‹ï¼ˆ3%ã§é»’ã„åŒ–çŸ³ï¼‰ã€‚<br>
          </div>
        </div>

      </div>
    </div>
  </div>

  <!-- âœ… ãƒˆãƒ¼ã‚¹ãƒˆï¼ˆtakofarm.js ã® toast() ãŒã“ã“ã«å‡ºã™ï¼‰ -->
  <div class="tf-toast" aria-live="polite"></div>

  <!-- =========================
       å›³é‘‘ãƒ¢ãƒ¼ãƒ€ãƒ«ï¼ˆç®±ã ã‘ï¼‰
       â€» renderDex() ã¯æ¬¡ã«è¿½åŠ ã§OK
  ========================= -->
  <div id="tfDexModal" class="tf-modal" aria-hidden="true">
    <div class="tf-modal__panel" role="dialog" aria-modal="true" aria-label="å›³é‘‘">
      <div class="tf-modal__head">
        <h2>å›³é‘‘ï¼ˆæ‰€æŒã‚«ãƒ¼ãƒ‰ï¼‰</h2>
        <button class="tf-modal__close" type="button" data-close="tfDexModal" aria-label="é–‰ã˜ã‚‹">Ã—</button>
      </div>

      <div class="tf-modal__body">
        <div class="tf-hud" style="margin-bottom:10px;">
          <span class="tf-pill">ğŸª™ OCTOï¼š<b id="dexOcto">0</b></span>
          <span class="tf-pill">ç™»éŒ²ï¼š<b id="dexCount">0</b></span>
        </div>

        <div id="tfDexGrid" class="tf-dex"></div>

        <div class="tf-mini" style="margin-top:10px;">
          â€»å›³é‘‘æç”»ï¼ˆrenderDexï¼‰ã¯æ¬¡ã«è¿½åŠ ã§ãã¾ã™ã€‚
        </div>
      </div>
    </div>
  </div>

  <!-- âœ… å…±æœ‰JSï¼ˆã‚ãªãŸã®takofarm.jsï¼‰ -->
  <script src="./takofarm.js"></script>

  <!-- âœ… å›³é‘‘ãƒ¢ãƒ¼ãƒ€ãƒ«é–‹é–‰ï¼ˆè»½ã„ï¼‰ -->
  <script>
  (() => {
    const open = (id) => {
      const m = document.getElementById(id);
      if(!m) return;
      m.classList.add("tf-open");
      m.setAttribute("aria-hidden","false");
    };
    const close = (id) => {
      const m = document.getElementById(id);
      if(!m) return;
      m.classList.remove("tf-open");
      m.setAttribute("aria-hidden","true");
    };

    document.getElementById("openDex")?.addEventListener("click", () => {
      // å›³é‘‘è¡¨ç¤ºï¼ˆå®Ÿè£…æ¸ˆã¿ãªã‚‰ï¼‰
      // window.TakoFarm?.renderDex?.();
      open("tfDexModal");
    });

    document.querySelectorAll("[data-close]").forEach(btn => {
      btn.addEventListener("click", () => close(btn.getAttribute("data-close")));
    });

    document.getElementById("tfDexModal")?.addEventListener("click",(e)=>{
      if(e.target.id === "tfDexModal") close("tfDexModal");
    });

    document.addEventListener("keydown", (e) => {
      if(e.key !== "Escape") return;
      close("tfDexModal");
    });
  })();
  </script>
</body>
</html>

