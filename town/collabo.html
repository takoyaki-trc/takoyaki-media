// ===== タブ切替（現物 / デジタル） =====
const tabPaper = document.getElementById("tabPaper");
const tabDigital = document.getElementById("tabDigital");
const paperSubTabs = document.getElementById("paperSubTabs");
const digitalNote = document.getElementById("digitalNote");

const state2 = {
  mode: "paper",      // "paper" | "digital"
  paper: "sale",      // "sale" | "legend"
};

function setMode(mode){
  state2.mode = mode;
  tabPaper.setAttribute("aria-selected", String(mode==="paper"));
  tabDigital.setAttribute("aria-selected", String(mode==="digital"));

  paperSubTabs.style.display = (mode==="paper") ? "" : "none";
  digitalNote.hidden = (mode!=="digital");

  render2();
}

paperSubTabs.addEventListener("click", (e) => {
  const btn = e.target.closest(".subtab");
  if(!btn) return;
  state2.paper = btn.dataset.paper;
  paperSubTabs.querySelectorAll(".subtab").forEach(b => b.setAttribute("aria-pressed","false"));
  btn.setAttribute("aria-pressed","true");
  render2();
});

tabPaper.addEventListener("click", () => setMode("paper"));
tabDigital.addEventListener("click", () => setMode("digital"));

// ===== 表示側：現物は sale/legend を切替、デジタルは今は空でもOK =====
function render2(){
  // ここであなたの既存データを使う想定：
  // SALE_CARDS / LEGEND_CARDS を使って描画先を切り替える

  if(state2.mode === "digital"){
    // デジタルは今後追加予定なら「空表示」や「準備中」でもOK
    grid.innerHTML = "";
    legendArea.style.display = "none";
    countLine.textContent = "0 / 0";
    return;
  }

  // 現物モード
  if(state2.paper === "sale"){
    legendArea.style.display = "none";
    const list = sortCards(SALE_CARDS.filter(matches));
    grid.innerHTML = "";
    list.forEach(c => grid.appendChild(makeTile(c,false)));
    countLine.textContent = `${list.length} / ${SALE_CARDS.length}`;
    return;
  }

  // 非売品モード
  grid.innerHTML = "";
  legendArea.style.display = "";
  legendScroll.innerHTML = "";
  sortCards(LEGEND_CARDS).forEach(c => legendScroll.appendChild(makeTile(c,true)));
  countLine.textContent = `${LEGEND_CARDS.length} / ${LEGEND_CARDS.length}`;
}

setMode("paper");


